<!doctype html>
<html>
<head>
    <base href="https://www.ory.am"><link href="style.css" rel="stylesheet">
    <title>Run your own open source OAuth2 server - step by step guide</title>
    <link rel="icon" type="image/png" href="https://storage.googleapis.com/ory.am/logo/ory_07_-15.png">
    <link rel="apple-touch-icon" type="image/png" href="https://storage.googleapis.com/ory.am/logo/ory_07_-15.png">
    <link rel="icon" sizes="144x144" href="https://storage.googleapis.com/ory.am/logo/ory_07_-15.png">
    <meta charset="utf-8">
    <meta name="description" content="Run your own open source OAuth2 server - step by step guide">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type="text/css">
        .clarke-header-content h2,
        .clarke-header-content h3,
        .clarke-header-content h4,
        .clarke-header-content h5,
        .clarke-header-content h6,
        .clarke-header-content p {
            color: rgba(255, 255, 255, 0.85) !important;
        }

        .clarke-header-content h1 {
            color: rgba(255, 255, 255, 1) !important;
        }

        .clarke-main-inner h1,
        .clarke-main-inner h2,
        .clarke-main-inner h3,
        .clarke-main-inner h4 {
            text-transform: none !important;
        }

        .clarke-main-inner h3 {
            font-size: 18px !important;
        }

        .clarke-main-inner .ory-layout-plugin-section-dark h3 {
            color: #f4f4f4 !important;
        }

        .clarke .clarke-header .menu-sticky-top .menu-sticky-top-nav ul li a {
            text-transform: none !important;
        }

        .clarke .clarke-header .menu-sticky-top .menu-sticky-top-nav,
        .clarke .clarke-header .menu-sticky-top .menu-sticky-top-nav ul {
            background-color: #f4f4f4 !important;
        }

        .clarke .clarke-header .menu-sticky-top .menu-sticky-top-nav ul li ul {
            border-top: 1px solid #bbb;
        }

        nav.menu-sticky-top {
            padding: 0 !important;
        }

        .clarke-footer-nav li {
            margin: 16px;
        }

        nav.menu-sticky-top .menu-sticky-top-nav .menu-sticky-top-brand img {
            height: 35px !important;
        }

        .clarke-header {
            background-position-y: top !important;
        }

        .clarke-header-content {
            padding-top: 25vh !important;
            padding-bottom: 25vh !important;
        }

        @media screen and (max-device-width: 1050px) {
            .clarke-header {
                background-attachment: scroll !important;
            }
        }

        @media screen and (max-device-width: 420px) {
            .ory-plugins-content-image {
                max-width: 80%;
                margin: auto 0;
            }
        }

        .editable-area pre:before {
            content: " ";
            position: absolute;
            top: -1px;
            left: 0;
            right: 0;
            background: #DAD9D9;
            height: 24px;
            border-radius: 4px 4px 0 0;
        }

        .editable-area code {
            line-height: 1em;
            display: inline;
            background: rgba(27, 31, 35, 0.15);
            font-size: .85em;
            padding: 0 0.5em 0.1em 0.5em !important;
            margin: 0 !important;
            border-radius: 3px !important;
        }

        .editable-area pre {
            display: block;
            margin: 1em !important;
            overflow: visible !important;
            background: #333;
            border-radius: 0 0 4px 4px;
            color: white;
            padding: 44px 20px 20px 20px !important;
            position: relative;
        }

        .editable-area pre code {
            margin: 0 !important;
            padding: 0 !important;
            white-space: pre-wrap;
            line-height: 1.25em;
            color: white;
            background: none;
        }

        .editable-area .material-icons {
            color: #14193D !important;
        }

        .ory-layout-plugin-section-dark .material-icons {
            color: #f4f4f4 !important;
        }

        iframe {
            overflow: hidden;
        }
    </style>
    <script>
      function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.body.scrollHeight + 5 + 'px';
      }
    </script>
</head>
<body data-page="12d80bfe-203e-419b-b421-9e7549513b06">
<div id="root">
    <div><div class="clarke"><div class="clarke-header" style="background:linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(&#x27;images/pexels-photo-65125.jpeg&#x27;) center / cover no-repeat fixed;"><nav class="menu-sticky-top"><div><div style="padding-bottom:0;"></div><div class="menu-sticky-top-nav" style="transform:translateZ(0);"><div class="menu-sticky-top-nav-inner"><div class="menu-sticky-top-nav-items-container"><ul><li class="menu-sticky-top-nav-responsive-toggle"><a href="#">☰</a></li><li><a class="" href="index.html">Welcome</a></li><li><a class="" href="products/open-source.html">Open Source</a></li><li><input type="checkbox" id="807372c8-dc34-4a8b-a7b9-c7e50de10381"/><label for="807372c8-dc34-4a8b-a7b9-c7e50de10381"><a class="" href="">API Security</a></label><ul><li><a class="" href="products/cloud-security.html">Overview</a></li><li><a class="" href="products/account-takeover-detection-api.html">Account Takeover</a></li></ul></li><li><a class="" href="https://www.ory.am/sites">Static Site Generator</a></li><li><input type="checkbox" id="114d0c8d-7cb1-4794-9ae9-69f9a1dc6f2a"/><label for="114d0c8d-7cb1-4794-9ae9-69f9a1dc6f2a"><a class="" href="">Articles</a></label><ul><li><a class="" href="golang-go-code-coverage-accurate.html">Accurate Go Code Coverage</a></li><li><a class="" href="run-oauth2-server-open-source-api-security.html">Run and install ORY Hydra</a></li></ul></li><li><a class="" href="https://github.com/ory">GitHub</a></li></ul></div><div class="menu-sticky-top-brand"><a href="index.html"><img src="https://storage.googleapis.com/ory.am/logo/ory_07_-26-no-border.png"/></a></div><div style="clear:both;"></div></div></div></div></nav><div class="clarke-header-content"><div class="editable-area"><div class="ory-row"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h1 style="text-align:left;">RUN YOUR OWN<br/>OAuth2 Server</h1><h2 style="text-align:left;">api security using SECURE AND<br/>scalable open source technology</h2></div></div></div></div></div></div></div><div class="clarke-main"><div class="clarke-main-inner"><div class="editable-area"><div class="ory-row"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner"><div class="ory-layout-plugin-section ory-layout-plugin-section-grey" id=""><div class="ory-layout-plugin-section-inner"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><p>In this guide, you will set up a hardened, fully functional OAuth 2.0 (OAuth2) server. It will take you about ~15 minutes. This guide is for you, if you are looking to do something like in the gif on the right, or more specifically:</p><ul><li><p>You want to use OAuth2 for API security.</p></li><li><p>You want to open up your API to third party developers like <a href="https://www.dropbox.com/developers">Dropbox</a>, or <a href="https://developer.github.com/v3/">GitHub</a>.</p></li><li><p>You want to become an identity provider like <a href="https://developers.google.com/identity/">Google</a>, <a href="https://developers.facebook.com/docs/facebook-login">Facebook</a>, or <a href="https://dev.twitter.com/web/sign-in">Twitter</a>.</p></li><li><p>You need to federate (delegate) authentication or authorization.</p></li></ul><p>We will use <a href="https://github.com/ory/hydra">ORY Hydra</a> (open source), a security-first OAuth2 and OpenID Connect server written in Golang.</p></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><img class="ory-plugins-content-image" src="images/oauth2-flow.gif"/></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>This is how ORY Hydra works</h3><p>I originally built ORY Hydra because all other OAuth2 servers forced their user management on me. But I had a user management in place already, and did not want to migrate away from it. Some of the providers allowed me to integrate with LDAP or SAML, but this was not implemented in my user management.</p><p>ORY Hydra defines a consent flow which let&#x27;s you implement the bridge between ORY Hydra and your user management easily using only a few lines of code. If you want, you could say that ORY Hydra translates the user information you provide to OAuth2 Access Tokens and OpenID Connect ID Tokens, which are then reusable across all your applications (web app, mobile app, CRM, Mail, ...) and also by third-party developers.</p></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Sounds good, let&#x27;s go!</h3><p>You&#x27;re hooked? Great! Let&#x27;s start by downloading some docker images. By the way, this tutorial relies heavily on docker. If you haven&#x27;t already, please install docker now.</p></div></div></div></div><div><div style="color:rgba(0, 0, 0, 0.87);background-color:#ffffff;transition:-ms-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0,0,0,0);box-shadow:none;border-radius:0px;height:auto;width:auto;position:fixed;z-index:5;left:0px;top:inherit;transform:translate(0, 300px);overflow:visible;-webkit-overflow-scrolling:touch;bottom:0px;margin:0 auto;right:0px;text-align:center;background:transparent;border:transparent;-webkit-transition:-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;-webkit-transform:translate(0, 300px);-ms-transform:translate(0, 300px);"><div style="display:inline-block;border:rgba(0, 0, 0, 0.87) 1px solid;border-radius:4px 4px 0;background-color:rgba(0, 0, 0, 0.87);padding:12px 24px;"><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-my-anchor-Linkableanchorname-56446">Linkable anchor name</label><div style="position:absolute;opacity:0;color:grey;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;bottom:12px;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;">my-anchor</div><input type="text" style="appearance:textfield;padding:0;position:relative;width:100%;border:none;outline:none;background-color:rgba(0,0,0,0);color:white;cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);height:100%;box-sizing:border-box;margin-top:14px;text-align:left;-webkit-appearance:textfield;-moz-appearance:textfield;-moz-box-sizing:border-box;" value="" id="undefined-my-anchor-Linkableanchorname-56446"/><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;color:white;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(0.75) translate(0, -28px);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(0.75) translate(0, -28px);-ms-transform:scale(0.75) translate(0, -28px);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-undefined-Style-53202">Style</label><div id="undefined-undefined-Style-53202" style="display:block;font-size:15px;height:100%;font-family:Roboto, sans-serif;outline:none;position:relative;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;padding:0;width:100%;border:none;background-color:rgba(0,0,0,0);color:rgba(0, 0, 0, 0.87);cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;margin-top:14px;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;"><div style="cursor:pointer;height:100%;position:relative;width:100%;"><div style="box-sizing:border-box;content:&#x27; &#x27;;display:table;-moz-box-sizing:border-box;"></div><div style="color:white;height:56px;line-height:56px;overflow:hidden;opacity:1;position:relative;padding-left:0;padding-right:56px;text-overflow:ellipsis;top:6px;white-space:nowrap;text-align:left;">grey</div><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:absolute;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;fill:#e0e0e0;right:0;top:8px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button"><div><svg style="display:inline-block;color:rgba(0, 0, 0, 0.87);fill:inherit;height:24px;width:24px;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg></div></button><div style="border-top:none;bottom:1px;left:0;margin:-1px 24px;right:0;position:absolute;"></div><div style="box-sizing:border-box;content:&#x27; &#x27;;clear:both;display:table;-moz-box-sizing:border-box;"></div></div><div style="display:none;"></div></div><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div></div></div></div></div></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner"><div class="ory-layout-plugin-section ory-layout-plugin-section-white" id=""><div class="ory-layout-plugin-section-inner"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h2>Install and run PostgreSQL</h2></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><p>First, a database is required, and we will choose PostgreSQL 9.6 (MySQL is also supported).</p><p>This docker command starts postgres container <code>ory-hydra-example--postgres</code> and sets up a database called <code>hydra</code> with user <code>hydra</code> and password <code>secret</code>.</p></div></div></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ docker run \<br/>  --name ory-postgres \<br/>  -e POSTGRES_USER=hydra \<br/>  -e POSTGRES_PASSWORD=secret \<br/>  -e POSTGRES_DB=hydra \<br/>  -d postgres:9.6</code></pre></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><p>By the way, don&#x27;t deploy databases using docker in production. It will make your life miserable. Use a managed solution like <a href="https://aws.amazon.com/de/rds/">Amazon RDS</a> or <a href="https://cloud.google.com/sql/docs/">Google Cloud SQL</a>. Even small instances will be able to serve a lot of traffic, check out some of the <a href="https://github.com/ory/hydra/issues/161">benchmarks</a>.</p></div></div></div></div><div><div style="color:rgba(0, 0, 0, 0.87);background-color:#ffffff;transition:-ms-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0,0,0,0);box-shadow:none;border-radius:0px;height:auto;width:auto;position:fixed;z-index:5;left:0px;top:inherit;transform:translate(0, 300px);overflow:visible;-webkit-overflow-scrolling:touch;bottom:0px;margin:0 auto;right:0px;text-align:center;background:transparent;border:transparent;-webkit-transition:-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;-webkit-transform:translate(0, 300px);-ms-transform:translate(0, 300px);"><div style="display:inline-block;border:rgba(0, 0, 0, 0.87) 1px solid;border-radius:4px 4px 0;background-color:rgba(0, 0, 0, 0.87);padding:12px 24px;"><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-my-anchor-Linkableanchorname-52013">Linkable anchor name</label><div style="position:absolute;opacity:0;color:grey;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;bottom:12px;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;">my-anchor</div><input type="text" style="appearance:textfield;padding:0;position:relative;width:100%;border:none;outline:none;background-color:rgba(0,0,0,0);color:white;cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);height:100%;box-sizing:border-box;margin-top:14px;text-align:left;-webkit-appearance:textfield;-moz-appearance:textfield;-moz-box-sizing:border-box;" value="" id="undefined-my-anchor-Linkableanchorname-52013"/><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;color:white;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(0.75) translate(0, -28px);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(0.75) translate(0, -28px);-ms-transform:scale(0.75) translate(0, -28px);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-undefined-Style-7946">Style</label><div id="undefined-undefined-Style-7946" style="display:block;font-size:15px;height:100%;font-family:Roboto, sans-serif;outline:none;position:relative;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;padding:0;width:100%;border:none;background-color:rgba(0,0,0,0);color:rgba(0, 0, 0, 0.87);cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;margin-top:14px;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;"><div style="cursor:pointer;height:100%;position:relative;width:100%;"><div style="box-sizing:border-box;content:&#x27; &#x27;;display:table;-moz-box-sizing:border-box;"></div><div style="color:white;height:56px;line-height:56px;overflow:hidden;opacity:1;position:relative;padding-left:0;padding-right:56px;text-overflow:ellipsis;top:6px;white-space:nowrap;text-align:left;">white</div><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:absolute;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;fill:#e0e0e0;right:0;top:8px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button"><div><svg style="display:inline-block;color:rgba(0, 0, 0, 0.87);fill:inherit;height:24px;width:24px;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg></div></button><div style="border-top:none;bottom:1px;left:0;margin:-1px 24px;right:0;position:absolute;"></div><div style="box-sizing:border-box;content:&#x27; &#x27;;clear:both;display:table;-moz-box-sizing:border-box;"></div></div><div style="display:none;"></div></div><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div></div></div></div></div></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner"><div class="ory-layout-plugin-section ory-layout-plugin-section-" id=""><div class="ory-layout-plugin-section-inner"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h2 style="text-align:center;">Configure the environment</h2></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ export SYSTEM_SECRET=y82XL-wAPCCZu+B4</code></pre></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>System Secret</h3><p>The <strong>system secret </strong>is used to <strong>encrypt data </strong>at rest, and to <strong>sign tokens</strong> and authorize codes. Once a database is initialized with a system secret, you always need to use that secret to access the database.</p></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ export DATABASE_URL=postgres://hydra:secret@postgres:5432/hydra?sslmode=disable</code></pre></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Database</h3><p>The database url must point to the postgres container we created above. The database will be used to persist and query data. <strong>ORY Hydra prevents data leaks</strong> as only token signatures are stored in the database. For a valid token, both payload and signature are required.</p></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ docker pull oryd/hydra:v0.9.12<br/>$ docker run \<br/>  --link ory-postgres:postgres \<br/>  -it --entrypoint \<br/>  hydra oryd/hydra:latest \<br/>  migrate sql $DATABASE_URL<br/></code></pre></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3 style="text-align:left;">Initialize the database</h3><p style="text-align:left;">Next, the database needs to be initialized. This can be achieved with <code>hydra migrate sql</code>. Here we pull the latest docker image for ORY Hydra and run a container that executes the migrate command.</p><p style="text-align:left;">To prevent bad things from happening, SQL migrations are never run without you explicitly telling them to. This is the case for new and existing databases.</p></div></div></div></div><div><div style="color:rgba(0, 0, 0, 0.87);background-color:#ffffff;transition:-ms-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0,0,0,0);box-shadow:none;border-radius:0px;height:auto;width:auto;position:fixed;z-index:5;left:0px;top:inherit;transform:translate(0, 300px);overflow:visible;-webkit-overflow-scrolling:touch;bottom:0px;margin:0 auto;right:0px;text-align:center;background:transparent;border:transparent;-webkit-transition:-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;-webkit-transform:translate(0, 300px);-ms-transform:translate(0, 300px);"><div style="display:inline-block;border:rgba(0, 0, 0, 0.87) 1px solid;border-radius:4px 4px 0;background-color:rgba(0, 0, 0, 0.87);padding:12px 24px;"><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-my-anchor-Linkableanchorname-50261">Linkable anchor name</label><div style="position:absolute;opacity:0;color:grey;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;bottom:12px;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;">my-anchor</div><input type="text" style="appearance:textfield;padding:0;position:relative;width:100%;border:none;outline:none;background-color:rgba(0,0,0,0);color:white;cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);height:100%;box-sizing:border-box;margin-top:14px;text-align:left;-webkit-appearance:textfield;-moz-appearance:textfield;-moz-box-sizing:border-box;" value="" id="undefined-my-anchor-Linkableanchorname-50261"/><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;color:white;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-undefined-Style-40779">Style</label><div id="undefined-undefined-Style-40779" style="display:block;font-size:15px;height:100%;font-family:Roboto, sans-serif;outline:none;position:relative;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;padding:0;width:100%;border:none;background-color:rgba(0,0,0,0);color:rgba(0, 0, 0, 0.87);cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;margin-top:14px;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;"><div style="cursor:pointer;height:100%;position:relative;width:100%;"><div style="box-sizing:border-box;content:&#x27; &#x27;;display:table;-moz-box-sizing:border-box;"></div><div style="color:white;height:56px;line-height:56px;overflow:hidden;opacity:1;position:relative;padding-left:0;padding-right:56px;text-overflow:ellipsis;top:6px;white-space:nowrap;text-align:left;"></div><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:absolute;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;fill:#e0e0e0;right:0;top:8px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button"><div><svg style="display:inline-block;color:rgba(0, 0, 0, 0.87);fill:inherit;height:24px;width:24px;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg></div></button><div style="border-top:none;bottom:1px;left:0;margin:-1px 24px;right:0;position:absolute;"></div><div style="box-sizing:border-box;content:&#x27; &#x27;;clear:both;display:table;-moz-box-sizing:border-box;"></div></div><div style="display:none;"></div></div><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div></div></div></div></div></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner"><div class="ory-layout-plugin-section ory-layout-plugin-section-white" id=""><div class="ory-layout-plugin-section-inner"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h2>Run the OAuth2 server</h2><p>Besides setting the <strong>system secret </strong>(<code>SYSTEM_SECRET</code>), the <strong>database url </strong>(<code>DATABASE_URL</code>), the <strong>public url</strong> (<code>ISSUER</code>) of the server and the <strong>root client credentials</strong> (<code>FORCE_ROOT_CLIENT_CREDENTIALS</code>) used to manage ORY Hydra, a <strong>consent url</strong> (<code>CONSENT_URL</code>) is passed using environment variables.</p><p>The <strong>consent url</strong> points to a web service which will be explained and set up in the next sections. It connects Hydra to your identity management and is part of the <strong>consent flow</strong>.</p><p><em>Please use more secure values in production. ;)</em></p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ docker run -d \<br/>  --name ory-hydra \<br/>  --link ory-postgres:postgres \<br/>  -p 9000:4444 \<br/>  -e SYSTEM_SECRET=$SYSTEM_SECRET \<br/>  -e DATABASE_URL=$DATABASE_URL \<br/>  -e ISSUER=https://localhost:9000/ \<br/>  -e CONSENT_URL=http://localhost:9020/consent \<br/>  -e FORCE_ROOT_CLIENT_CREDENTIALS=admin:demo-password \<br/>  oryd/hydra:v0.9.12</code></pre></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Is it alive?</h3><p>This is easy to answer, just check the docker logs! Or, <a href="https://localhost:9000/health">open the health check</a>, which should show you <code>ok</code>.</p><p>If asked, <strong>accept the self signed certificate</strong> in your browser.</p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ docker logs ory-hydra<br/><br/>[...]<br/>time=&quot;2017-06-29T21:26:34Z&quot; level=info msg=&quot;Setting up http server on :4444&quot;</code></pre></div></div></div></div><div><div style="color:rgba(0, 0, 0, 0.87);background-color:#ffffff;transition:-ms-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0,0,0,0);box-shadow:none;border-radius:0px;height:auto;width:auto;position:fixed;z-index:5;left:0px;top:inherit;transform:translate(0, 300px);overflow:visible;-webkit-overflow-scrolling:touch;bottom:0px;margin:0 auto;right:0px;text-align:center;background:transparent;border:transparent;-webkit-transition:-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;-webkit-transform:translate(0, 300px);-ms-transform:translate(0, 300px);"><div style="display:inline-block;border:rgba(0, 0, 0, 0.87) 1px solid;border-radius:4px 4px 0;background-color:rgba(0, 0, 0, 0.87);padding:12px 24px;"><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-my-anchor-Linkableanchorname-10743">Linkable anchor name</label><div style="position:absolute;opacity:0;color:grey;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;bottom:12px;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;">my-anchor</div><input type="text" style="appearance:textfield;padding:0;position:relative;width:100%;border:none;outline:none;background-color:rgba(0,0,0,0);color:white;cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);height:100%;box-sizing:border-box;margin-top:14px;text-align:left;-webkit-appearance:textfield;-moz-appearance:textfield;-moz-box-sizing:border-box;" value="" id="undefined-my-anchor-Linkableanchorname-10743"/><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;color:white;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(0.75) translate(0, -28px);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(0.75) translate(0, -28px);-ms-transform:scale(0.75) translate(0, -28px);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-undefined-Style-59849">Style</label><div id="undefined-undefined-Style-59849" style="display:block;font-size:15px;height:100%;font-family:Roboto, sans-serif;outline:none;position:relative;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;padding:0;width:100%;border:none;background-color:rgba(0,0,0,0);color:rgba(0, 0, 0, 0.87);cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;margin-top:14px;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;"><div style="cursor:pointer;height:100%;position:relative;width:100%;"><div style="box-sizing:border-box;content:&#x27; &#x27;;display:table;-moz-box-sizing:border-box;"></div><div style="color:white;height:56px;line-height:56px;overflow:hidden;opacity:1;position:relative;padding-left:0;padding-right:56px;text-overflow:ellipsis;top:6px;white-space:nowrap;text-align:left;">white</div><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:absolute;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;fill:#e0e0e0;right:0;top:8px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button"><div><svg style="display:inline-block;color:rgba(0, 0, 0, 0.87);fill:inherit;height:24px;width:24px;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg></div></button><div style="border-top:none;bottom:1px;left:0;margin:-1px 24px;right:0;position:absolute;"></div><div style="box-sizing:border-box;content:&#x27; &#x27;;clear:both;display:table;-moz-box-sizing:border-box;"></div></div><div style="display:none;"></div></div><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div></div></div></div></div></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner"><div class="ory-layout-plugin-section ory-layout-plugin-section-" id=""><div class="ory-layout-plugin-section-inner"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h2 style="text-align:center;">Generate and validate tokens</h2></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ docker run -p 9010:4445 \<br/>  --link ory-hydra:hydra \<br/>  -it --entrypoint &quot;/bin/sh&quot; \<br/>  oryd/hydra:v0.9.12</code></pre></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>SSH into bash container with Hydra</h3><p>In this section, you will connect to the Hydra instance and generate and validate access tokens for the root client. To save you the trouble of installing Hydra locally, SSH into a container running bash with the ORY Hydra command line interface (CLI) installed.</p></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ hydra connect<br/><br/>Cluster URL []: https://hydra:4444<br/>Client ID []: admin<br/>Client Secret [empty]: demo-password</code></pre></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Connect with Hydra</h3><p>The command line interface (CLI) needs to know where Hydra is and what client id and secret should be used. Since we used <code>FORCE_ROOT_CLIENT_CREDENTIALS=admin:demo-password</code> when creating the container, we know that the combination is <code>admin:demo-password</code>.</p></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ hydra token client --skip-tls-verify<br/><br/>tY9tGakiYAUn8VIGn_yCDlTahckSfGbDQIlXahjXtX0.BQlCxRDL3ngag6hdsSl9N2qrz7R399cQMfld8aI2Mlg</code></pre></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Issue an access token</h3><p>Using <code>hydra token client it</code> is possible to obtain an access token for the client we used during <code>hydra connect</code>, in our case that&#x27;s admin.</p><p>Because only a self-signed TLS (for HTTPS) certificate is available, all interactions must skip TLS certificate verification which can be achieved with the flag <code>--skip-tls-verify</code>.</p></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ hydra token validate \<br/>  --skip-tls-verify \<br/>  $(hydra token client --skip-tls-verify)<br/><br/>{<br/>  &quot;active&quot;: true,<br/>  &quot;sub&quot;: &quot;admin&quot;,<br/>[...]</code></pre></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Validate an access token</h3><p>Using <code>hydra token validate</code> it is possible to validate an access token, and receive it&#x27;s payload. ORY Hydra uses opaque tokens to greatly reduce attack vectors. The payload of the token can be modified using the <a href="https://ory.gitbooks.io/hydra/content/oauth2.html#consent-app-flow"><strong>consent response</strong></a>.</p><p>You can validate access tokens using the <a href="http://docs.hydra13.apiary.io/#reference/oauth2/oauth2introspect">Introspection API</a>, standardized as <a href="https://tools.ietf.org/html/rfc7662">IETF OAuth 2.0 Token Introspection</a>.</p></div></div></div></div><div><div style="color:rgba(0, 0, 0, 0.87);background-color:#ffffff;transition:-ms-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0,0,0,0);box-shadow:none;border-radius:0px;height:auto;width:auto;position:fixed;z-index:5;left:0px;top:inherit;transform:translate(0, 300px);overflow:visible;-webkit-overflow-scrolling:touch;bottom:0px;margin:0 auto;right:0px;text-align:center;background:transparent;border:transparent;-webkit-transition:-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;-webkit-transform:translate(0, 300px);-ms-transform:translate(0, 300px);"><div style="display:inline-block;border:rgba(0, 0, 0, 0.87) 1px solid;border-radius:4px 4px 0;background-color:rgba(0, 0, 0, 0.87);padding:12px 24px;"><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-my-anchor-Linkableanchorname-42549">Linkable anchor name</label><div style="position:absolute;opacity:0;color:grey;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;bottom:12px;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;">my-anchor</div><input type="text" style="appearance:textfield;padding:0;position:relative;width:100%;border:none;outline:none;background-color:rgba(0,0,0,0);color:white;cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);height:100%;box-sizing:border-box;margin-top:14px;text-align:left;-webkit-appearance:textfield;-moz-appearance:textfield;-moz-box-sizing:border-box;" value="" id="undefined-my-anchor-Linkableanchorname-42549"/><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;color:white;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-undefined-Style-54716">Style</label><div id="undefined-undefined-Style-54716" style="display:block;font-size:15px;height:100%;font-family:Roboto, sans-serif;outline:none;position:relative;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;padding:0;width:100%;border:none;background-color:rgba(0,0,0,0);color:rgba(0, 0, 0, 0.87);cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;margin-top:14px;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;"><div style="cursor:pointer;height:100%;position:relative;width:100%;"><div style="box-sizing:border-box;content:&#x27; &#x27;;display:table;-moz-box-sizing:border-box;"></div><div style="color:white;height:56px;line-height:56px;overflow:hidden;opacity:1;position:relative;padding-left:0;padding-right:56px;text-overflow:ellipsis;top:6px;white-space:nowrap;text-align:left;"></div><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:absolute;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;fill:#e0e0e0;right:0;top:8px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button"><div><svg style="display:inline-block;color:rgba(0, 0, 0, 0.87);fill:inherit;height:24px;width:24px;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg></div></button><div style="border-top:none;bottom:1px;left:0;margin:-1px 24px;right:0;position:absolute;"></div><div style="box-sizing:border-box;content:&#x27; &#x27;;clear:both;display:table;-moz-box-sizing:border-box;"></div></div><div style="display:none;"></div></div><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div></div></div></div></div></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner"><div class="ory-layout-plugin-section ory-layout-plugin-section-white" id=""><div class="ory-layout-plugin-section-inner"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h2 style="text-align:center;">The consent flow</h2><p>ORY Hydra is not an <a href="https://en.wikipedia.org/wiki/Identity_management">Identity Management</a> solution. Instead it uses your existing Identity Management which reduces adoption complexity. OAuth2 providers such as Keycloak, OpenAM, or IdentityServer are usually full-stack enterprise identity and access management solutions. They come with complex deployment dependencies, technologies not particularly suited for cloud native environments, and subtle, but annoying limitations at scale. ORY Hydra solves OAuth2 and OpenID Connect only, but it solves it well and extremely scalable.</p></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><p>To authenticate users, ORY Hydra defines the <strong>consent flow.</strong> Example consent apps are available for <a href="https://github.com/ory/hydra-consent-app-go/blob/master/main.go">Go</a> and <a href="https://github.com/ory/hydra-consent-app-express">Node</a> as well as Consent SDKs for both languages.</p></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><img class="ory-plugins-content-image" src="images/ORY Hydra Consent Flow.png"/></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Create a consent client</h3><p>The consent app requires a registered OAuth 2.0 Client with the ability to access (<strong>scope</strong>) cryptographic keys (<code>hydra.keys.get</code>) through OAuth2 Access Tokens. The keys are required for validating and signing the consent challenge and the consent response.</p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ hydra clients create --skip-tls-verify \<br/>  --id consent-app \<br/>  --secret consent-secret \<br/>  --name &quot;Consent App Client&quot; \<br/>  --grant-types client_credentials \<br/>  --response-types token \<br/>  --allowed-scopes hydra.keys.get</code></pre></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Create access control policies for consent client</h3><p>ORY Hydra uses access control policies internally. This functionality is exposed as the <a href="http://docs.hydra13.apiary.io/#reference/warden">Warden API</a>. Since the consent app requires access to cryptographic keys, an access control policy for <code>consent-app</code> has to be created as well. This is different from an OAuth2 scope as it regulates the capabilities of the user (<code>consent-app</code>), not the scope of the access token.</p><p>Read more about <a href="https://ory.gitbooks.io/hydra/content/access-control.html">access control policies</a>.</p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ hydra policies create --skip-tls-verify \<br/>  --actions get \<br/>  --allow \<br/>  --id consent-app-policy \<br/>  --resources &quot;rn:hydra:keys:hydra.consent.&lt;.*&gt;&quot; \<br/>  --subjects consent-app</code></pre></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Run the consent app container</h3><p>Since there is an <a href="https://github.com/ory/hydra-consent-app-express">exemplary consent app for NodeJS</a> available, let&#x27;s use that one in docker and connect it to ORY Hydra. You need to <strong>run this command in a different shell</strong>. After running this command, return to the shell above for the remainder of this article.</p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ docker run -d \<br/>  --name ory-consent \<br/>  --link ory-hydra:hydra \<br/>  -p 9020:3000 \<br/>  -e HYDRA_CLIENT_ID=consent-app \<br/>  -e HYDRA_CLIENT_SECRET=consent-secret \<br/>  -e HYDRA_URL=https://hydra:4444 \<br/>  -e NODE_TLS_REJECT_UNAUTHORIZED=0 \<br/>  oryd/hydra-consent-app-express:latest</code></pre></div></div></div></div><div><div style="color:rgba(0, 0, 0, 0.87);background-color:#ffffff;transition:-ms-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0,0,0,0);box-shadow:none;border-radius:0px;height:auto;width:auto;position:fixed;z-index:5;left:0px;top:inherit;transform:translate(0, 300px);overflow:visible;-webkit-overflow-scrolling:touch;bottom:0px;margin:0 auto;right:0px;text-align:center;background:transparent;border:transparent;-webkit-transition:-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;-webkit-transform:translate(0, 300px);-ms-transform:translate(0, 300px);"><div style="display:inline-block;border:rgba(0, 0, 0, 0.87) 1px solid;border-radius:4px 4px 0;background-color:rgba(0, 0, 0, 0.87);padding:12px 24px;"><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-my-anchor-Linkableanchorname-44408">Linkable anchor name</label><div style="position:absolute;opacity:0;color:grey;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;bottom:12px;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;">my-anchor</div><input type="text" style="appearance:textfield;padding:0;position:relative;width:100%;border:none;outline:none;background-color:rgba(0,0,0,0);color:white;cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);height:100%;box-sizing:border-box;margin-top:14px;text-align:left;-webkit-appearance:textfield;-moz-appearance:textfield;-moz-box-sizing:border-box;" value="" id="undefined-my-anchor-Linkableanchorname-44408"/><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;color:white;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(0.75) translate(0, -28px);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(0.75) translate(0, -28px);-ms-transform:scale(0.75) translate(0, -28px);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-undefined-Style-38563">Style</label><div id="undefined-undefined-Style-38563" style="display:block;font-size:15px;height:100%;font-family:Roboto, sans-serif;outline:none;position:relative;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;padding:0;width:100%;border:none;background-color:rgba(0,0,0,0);color:rgba(0, 0, 0, 0.87);cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;margin-top:14px;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;"><div style="cursor:pointer;height:100%;position:relative;width:100%;"><div style="box-sizing:border-box;content:&#x27; &#x27;;display:table;-moz-box-sizing:border-box;"></div><div style="color:white;height:56px;line-height:56px;overflow:hidden;opacity:1;position:relative;padding-left:0;padding-right:56px;text-overflow:ellipsis;top:6px;white-space:nowrap;text-align:left;">white</div><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:absolute;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;fill:#e0e0e0;right:0;top:8px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button"><div><svg style="display:inline-block;color:rgba(0, 0, 0, 0.87);fill:inherit;height:24px;width:24px;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg></div></button><div style="border-top:none;bottom:1px;left:0;margin:-1px 24px;right:0;position:absolute;"></div><div style="box-sizing:border-box;content:&#x27; &#x27;;clear:both;display:table;-moz-box-sizing:border-box;"></div></div><div style="display:none;"></div></div><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div></div></div></div></div></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner"><div class="ory-layout-plugin-section ory-layout-plugin-section-" id=""><div class="ory-layout-plugin-section-inner"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h2 style="text-align:center;">OAuth2 + OpenID Connect Authorize Flow</h2></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Create OAuth2 Consumer App</h3><p>Awesome, the infrastructure is now set up! To perform the OAuth 2.0 and OpenID Connect flow, an OAuth 2.0 Client (consumer app) is required.</p><p>The client must be able to request the <code>authorize_code</code> grant, scopes <code>openid</code> and <code>offline</code>, and response types <code>token</code>, <code>code</code>, and <code>id_token</code>.</p><p>Allowing the <code>hydra.clients.get</code> let&#x27;s us request tokens capable of querying OAuth 2.0 Clients stored in ORY Hydra. This is just for demonstration purposes.</p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ hydra clients create --skip-tls-verify \<br/>  --id some-consumer \<br/>  --secret consumer-secret \<br/>  -g authorization_code,refresh_token,client_credentials \<br/>  -r token,code,id_token \<br/>  --allowed-scopes openid,offline,hydra.clients \<br/>  --callbacks http://localhost:9010/callback<br/><br/>Client ID: some-consumer<br/>Client Secret: consumer-secret</code></pre></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Perform OAuth 2.0 Authorize Code Flow</h3><p>To initialize an OAuth 2.0 authorize code flow, use the <code>hydra token user</code> command. It will generate the authorization url which the user must open in the browser. Requesting the authorization is the first step of the OAuth 2.0 authorize code flow.</p><p>We also request that the token allows us to manage and fetch OAuth 2.0 Clients from the database using the scope <code>hydra.clients</code>. We will use the token later to fetch those clients in an example.</p><p>Requesting OAuth 2.0 Access and Refresh tokens is usually done using a library for your programming language. Do not write this on your own. Here are some libraries for different languages: <a href="https://github.com/golang/oauth2">Golang</a>, <a href="https://github.com/lelylan/simple-oauth2">NodeJS</a>, <a href="https://github.com/thephpleague/oauth2-client">PHP</a>.</p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ hydra token user --skip-tls-verify \<br/>  --auth-url https://localhost:9000/oauth2/auth \<br/>  --token-url https://hydra:4444/oauth2/token \<br/>  --id some-consumer \<br/>  --secret consumer-secret \<br/>  --scopes openid,offline,hydra.clients \<br/>  --redirect http://localhost:9010/callback<br/><br/>Setting up callback listener on http://localhost:4445/callback<br/>Press ctrl + c on Linux / Windows or cmd + c on OSX to end the process.<br/>If your browser does not open automatically, navigate to:<br/><br/>        https://localhost:9000/oauth2/auth?client_id=some-consumer&amp;redirect_uri=http%3A%2F%2Flocalhost%3A9020%2Fcallback&amp;response_type=code&amp;scope=openid+offline+hydra.clients&amp;state=hfcyxoqoctwbnvrxrsuwgzfu&amp;nonce=lbeouolavuvcdhjefcnzlqur</code></pre></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Login &amp; Consent</h3><p>Next, you will be shown two screens. One is the log-in screen, and the other is the screen asking the users which permissions he want&#x27;s to grant. These two screens are fully in your control and you can do anything you want here. Just remember the security implications of, for example, automatically granting everyone admin rights. ;)</p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><img class="ory-plugins-content-image" src="images/articles/hydra-guide/consent-login.png"/></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><p>In the consent screen, make sure to tick all the boxes! You can try how the system works when not checking all of them later.</p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><img class="ory-plugins-content-image" src="images/articles/hydra-guide/consent-authz.png"/></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-5 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3>Access Token, Refresh Token &amp; ID Token!</h3><p>Once you logged in and granted some scopes, ORY Hydra will issue an access, a refresh (if scope <code>offline</code> was granted), and an id token (if scope <code>openid</code> was granted).</p></div></div></div><div class="ory-cell ory-cell-sm-7 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><img class="ory-plugins-content-image" src="https://ory.gitbooks.io/hydra/content/images/install-result.png"/></div></div></div></div><div><div style="color:rgba(0, 0, 0, 0.87);background-color:#ffffff;transition:-ms-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0,0,0,0);box-shadow:none;border-radius:0px;height:auto;width:auto;position:fixed;z-index:5;left:0px;top:inherit;transform:translate(0, 300px);overflow:visible;-webkit-overflow-scrolling:touch;bottom:0px;margin:0 auto;right:0px;text-align:center;background:transparent;border:transparent;-webkit-transition:-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;-webkit-transform:translate(0, 300px);-ms-transform:translate(0, 300px);"><div style="display:inline-block;border:rgba(0, 0, 0, 0.87) 1px solid;border-radius:4px 4px 0;background-color:rgba(0, 0, 0, 0.87);padding:12px 24px;"><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-my-anchor-Linkableanchorname-20728">Linkable anchor name</label><div style="position:absolute;opacity:0;color:grey;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;bottom:12px;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;">my-anchor</div><input type="text" style="appearance:textfield;padding:0;position:relative;width:100%;border:none;outline:none;background-color:rgba(0,0,0,0);color:white;cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);height:100%;box-sizing:border-box;margin-top:14px;text-align:left;-webkit-appearance:textfield;-moz-appearance:textfield;-moz-box-sizing:border-box;" value="" id="undefined-my-anchor-Linkableanchorname-20728"/><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;color:white;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-undefined-Style-2848">Style</label><div id="undefined-undefined-Style-2848" style="display:block;font-size:15px;height:100%;font-family:Roboto, sans-serif;outline:none;position:relative;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;padding:0;width:100%;border:none;background-color:rgba(0,0,0,0);color:rgba(0, 0, 0, 0.87);cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;margin-top:14px;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;"><div style="cursor:pointer;height:100%;position:relative;width:100%;"><div style="box-sizing:border-box;content:&#x27; &#x27;;display:table;-moz-box-sizing:border-box;"></div><div style="color:white;height:56px;line-height:56px;overflow:hidden;opacity:1;position:relative;padding-left:0;padding-right:56px;text-overflow:ellipsis;top:6px;white-space:nowrap;text-align:left;"></div><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:absolute;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;fill:#e0e0e0;right:0;top:8px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button"><div><svg style="display:inline-block;color:rgba(0, 0, 0, 0.87);fill:inherit;height:24px;width:24px;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg></div></button><div style="border-top:none;bottom:1px;left:0;margin:-1px 24px;right:0;position:absolute;"></div><div style="box-sizing:border-box;content:&#x27; &#x27;;clear:both;display:table;-moz-box-sizing:border-box;"></div></div><div style="display:none;"></div></div><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div></div></div></div></div></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner"><div class="ory-layout-plugin-section ory-layout-plugin-section-white" id=""><div class="ory-layout-plugin-section-inner"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h2 style="text-align:center;">Make an authorized request</h2></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><p>The last part of this tutorial is going to teach you how to <strong>make an authorized request</strong>. For demonstration purposes, we will use an ORY Hydra API. It is however no different from how requests would look like to your API.</p><p><strong>Run these commands in a new shell</strong> where you have access to curl. Do not close the ORY Hydra shell, we will need it soon.</p><p>To make an authorized request, copy the access token you received above and set it as the environment variable <code>ACCESS_TOKEN</code>.</p><p>But we are seeing an error message telling us that this request is not allowed. We just encountered access control policies in action.</p></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ export ACCESS_TOKEN=&lt;paste token from browser&gt;<br/>$ export ACCESS_TOKEN=fUAvz53...<br/><br/>$ curl \<br/>  --insecure \<br/>  -H &quot;Authorization: bearer $ACCESS_TOKEN&quot; \<br/>  https://127.0.0.1:9000/clients/some-consumer<br/><br/>{&quot;error&quot;:{&quot;code&quot;:500,&quot;message&quot;:&quot;Request was denied by default: The request is not allowed&quot;}}</code></pre></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><p>While the token is allowed to potentially access this API, the user itself is not! In order to be able to access this API, the user needs to have the permission to access it. The OAuth 2.0 scope is only representative for the Access Token, not the user!</p><p>Let&#x27;s allow this user access to the clients API by running <code>hydra policies create</code> in the ORY Hydra shell from the previous sections. The user id is set in the exemplary consent app we used and is <code>user:12345:dandean</code>.</p></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code> hydra policies create --skip-tls-verify \<br/>  --actions get \<br/>  --allow \<br/>  --id consent-app-policy \<br/>  --resources &quot;rn:hydra:clients:&lt;.*&gt;&quot; \<br/>  --subjects user:12345:dandean</code></pre></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><p>Now, re-running the curl command gives the expected result!</p></div></div></div><div class="ory-cell ory-cell-sm-6 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><pre style="overflow:scroll;"><code>$ curl --insecure \<br/>  -H &quot;Authorization: bearer $ACCESS_TOKEN&quot;<br/>  https://127.0.0.1:9000/clients/some-consumer<br/><br/>{<br/>  &quot;id&quot;:&quot;some-consumer&quot;,<br/>  &quot;client_name&quot;:&quot;&quot;,<br/>  &quot;redirect_uris&quot;:[&quot;http://localhost:9010/callback&quot;],<br/>  [...]<br/>}</code></pre></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><p>That&#x27;s it, you have a running OAuth2 server with an exemplary identity provider, and performed an OAuth2 request!</p><p><a href="https://github.com/ory/hydra">ORY Hydra</a> is an Apache 2.0 licensed Go server solving OAuth 2.0, OpenID Connect and API security in general. It secures several production systems around the world and has a vibrant and welcoming online community.</p></div></div></div></div><div><div style="color:rgba(0, 0, 0, 0.87);background-color:#ffffff;transition:-ms-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0,0,0,0);box-shadow:none;border-radius:0px;height:auto;width:auto;position:fixed;z-index:5;left:0px;top:inherit;transform:translate(0, 300px);overflow:visible;-webkit-overflow-scrolling:touch;bottom:0px;margin:0 auto;right:0px;text-align:center;background:transparent;border:transparent;-webkit-transition:-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;-webkit-transform:translate(0, 300px);-ms-transform:translate(0, 300px);"><div style="display:inline-block;border:rgba(0, 0, 0, 0.87) 1px solid;border-radius:4px 4px 0;background-color:rgba(0, 0, 0, 0.87);padding:12px 24px;"><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-my-anchor-Linkableanchorname-26793">Linkable anchor name</label><div style="position:absolute;opacity:0;color:grey;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;bottom:12px;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;">my-anchor</div><input type="text" style="appearance:textfield;padding:0;position:relative;width:100%;border:none;outline:none;background-color:rgba(0,0,0,0);color:white;cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);height:100%;box-sizing:border-box;margin-top:14px;text-align:left;-webkit-appearance:textfield;-moz-appearance:textfield;-moz-box-sizing:border-box;" value="" id="undefined-my-anchor-Linkableanchorname-26793"/><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;color:white;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(0.75) translate(0, -28px);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(0.75) translate(0, -28px);-ms-transform:scale(0.75) translate(0, -28px);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-undefined-Style-20035">Style</label><div id="undefined-undefined-Style-20035" style="display:block;font-size:15px;height:100%;font-family:Roboto, sans-serif;outline:none;position:relative;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;padding:0;width:100%;border:none;background-color:rgba(0,0,0,0);color:rgba(0, 0, 0, 0.87);cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;margin-top:14px;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;"><div style="cursor:pointer;height:100%;position:relative;width:100%;"><div style="box-sizing:border-box;content:&#x27; &#x27;;display:table;-moz-box-sizing:border-box;"></div><div style="color:white;height:56px;line-height:56px;overflow:hidden;opacity:1;position:relative;padding-left:0;padding-right:56px;text-overflow:ellipsis;top:6px;white-space:nowrap;text-align:left;">white</div><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:absolute;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;fill:#e0e0e0;right:0;top:8px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button"><div><svg style="display:inline-block;color:rgba(0, 0, 0, 0.87);fill:inherit;height:24px;width:24px;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg></div></button><div style="border-top:none;bottom:1px;left:0;margin:-1px 24px;right:0;position:absolute;"></div><div style="box-sizing:border-box;content:&#x27; &#x27;;clear:both;display:table;-moz-box-sizing:border-box;"></div></div><div style="display:none;"></div></div><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div></div></div></div></div></div></div></div></div><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner"><div class="ory-layout-plugin-section ory-layout-plugin-section-grey" id=""><div class="ory-layout-plugin-section-inner"><div class="ory-row ory-cell-inner"><div class="ory-cell ory-cell-sm-12 ory-cell-xs-12"><div class="ory-cell-inner ory-cell-leaf"><div><h3 style="text-align:center;">Check out <a href="https://github.com/ory/hydra">ORY Hydra at Github</a> and our<br/><a href="products/api-security.html">API Security</a> products.</h3></div></div></div></div><div><div style="color:rgba(0, 0, 0, 0.87);background-color:#ffffff;transition:-ms-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;box-sizing:border-box;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0,0,0,0);box-shadow:none;border-radius:0px;height:auto;width:auto;position:fixed;z-index:5;left:0px;top:inherit;transform:translate(0, 300px);overflow:visible;-webkit-overflow-scrolling:touch;bottom:0px;margin:0 auto;right:0px;text-align:center;background:transparent;border:transparent;-webkit-transition:-webkit-transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms,transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:transform 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;-webkit-transform:translate(0, 300px);-ms-transform:translate(0, 300px);"><div style="display:inline-block;border:rgba(0, 0, 0, 0.87) 1px solid;border-radius:4px 4px 0;background-color:rgba(0, 0, 0, 0.87);padding:12px 24px;"><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(1) translate(0, 0);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(1) translate(0, 0);-ms-transform:scale(1) translate(0, 0);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-my-anchor-Linkableanchorname-56260">Linkable anchor name</label><div style="position:absolute;opacity:0;color:grey;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;bottom:12px;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;">my-anchor</div><input type="text" style="appearance:textfield;padding:0;position:relative;width:100%;border:none;outline:none;background-color:rgba(0,0,0,0);color:white;cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);height:100%;box-sizing:border-box;margin-top:14px;text-align:left;-webkit-appearance:textfield;-moz-appearance:textfield;-moz-box-sizing:border-box;" value="" id="undefined-my-anchor-Linkableanchorname-56260"/><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div><div style="font-size:16px;line-height:24px;width:256px;height:72px;display:block;position:relative;background-color:transparent;font-family:Roboto, sans-serif;transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;cursor:auto;color:white;text-align:left;-webkit-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:height 200ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><label style="position:absolute;line-height:22px;top:38px;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;z-index:1;transform:scale(0.75) translate(0, -28px);transform-origin:left top;pointer-events:none;user-select:none;color:white;text-align:left;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-transform:scale(0.75) translate(0, -28px);-ms-transform:scale(0.75) translate(0, -28px);-webkit-transform-origin:left top;-ms-transform-origin:left top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" for="undefined-undefined-Style-48018">Style</label><div id="undefined-undefined-Style-48018" style="display:block;font-size:15px;height:100%;font-family:Roboto, sans-serif;outline:none;position:relative;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;padding:0;width:100%;border:none;background-color:rgba(0,0,0,0);color:rgba(0, 0, 0, 0.87);cursor:inherit;font:inherit;-webkit-opacity:1;-webkit-tap-highlight-color:rgba(0,0,0,0);box-sizing:border-box;margin-top:14px;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:border-box;"><div style="cursor:pointer;height:100%;position:relative;width:100%;"><div style="box-sizing:border-box;content:&#x27; &#x27;;display:table;-moz-box-sizing:border-box;"></div><div style="color:white;height:56px;line-height:56px;overflow:hidden;opacity:1;position:relative;padding-left:0;padding-right:56px;text-overflow:ellipsis;top:6px;white-space:nowrap;text-align:left;">grey</div><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:absolute;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;fill:#e0e0e0;right:0;top:8px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button"><div><svg style="display:inline-block;color:rgba(0, 0, 0, 0.87);fill:inherit;height:24px;width:24px;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg></div></button><div style="border-top:none;bottom:1px;left:0;margin:-1px 24px;right:0;position:absolute;"></div><div style="box-sizing:border-box;content:&#x27; &#x27;;clear:both;display:table;-moz-box-sizing:border-box;"></div></div><div style="display:none;"></div></div><div><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:1px;border-color:#e0e0e0;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;-moz-box-sizing:content-box;"/><hr aria-hidden="true" style="border-top:none;border-left:none;border-right:none;border-bottom-style:solid;border-bottom-width:2px;border-color:#00bcd4;bottom:8px;box-sizing:content-box;margin:0;position:absolute;width:100%;transform:scaleX(0);transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-box-sizing:content-box;-webkit-transform:scaleX(0);-ms-transform:scaleX(0);-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="clarke-footer"><div class="clarke-footer-inner"><ul class="clarke-footer-nav"><li><a href="imprint.html">Imprint</a></li><li><a href="mailto:hi@ory.am">Contact us</a></li><li><a href="http://github.com/ory/">ORY on GitHub</a></li><li><a href="https://en.serlo.org/serlo">We ❤ Serlo Education</a></li></ul></div></div></div></div>
</div>
<script type="text/javascript" src="bundle.js"></script>

<script type="text/javascript">
  window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
  heap.load("591747209");
  heap.addUserProperties({ test: 'master' });
</script>

<!-- Start of Async Drift Code -->
<script>
  !function () {
    var t;
    if (t = window.driftt = window.drift = window.driftt || [], !t.init) return t.invoked ? void (window.console && console.error && console.error("Drift snippet included twice.")) : (t.invoked = !0,
      t.methods = ["identify", "config", "track", "reset", "debug", "show", "ping", "page", "hide", "off", "on"],
      t.factory = function (e) {
        return function () {
          var n;
          return n = Array.prototype.slice.call(arguments), n.unshift(e), t.push(n), t;
        };
      }, t.methods.forEach(function (e) {
      t[e] = t.factory(e);
    }), t.load = function (t) {
      var e, n, o, i;
      e = 3e5, i = Math.ceil(new Date() / e) * e, o = document.createElement("script"),
        o.type = "text/javascript", o.async = !0, o.crossorigin = "anonymous", o.src = "https://js.driftt.com/include/" + i + "/" + t + ".js",
        n = document.getElementsByTagName("script")[0], n.parentNode.insertBefore(o, n);
    });
  }();
  drift.SNIPPET_VERSION = '0.3.1';
  drift.load('6fe8s8uiauzg');
</script>
<!-- End of Async Drift Code -->

<!-- Hotjar Tracking Code for http://ory.am -->
<script>
  (function (h, o, t, j, a, r) {
    h.hj = h.hj || function () {
        (h.hj.q = h.hj.q || []).push(arguments)
      };
    h._hjSettings = { hjid: 317432, hjsv: 5 };
    a = o.getElementsByTagName('head')[0];
    r = o.createElement('script');
    r.async = 1;
    r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
    a.appendChild(r);
  })(window, document, '//static.hotjar.com/c/hotjar-', '.js?sv=');
</script>

<!-- Google Analytics -->
<script>
  (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
    a = s.createElement(o),
      m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
  })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

  ga('create', 'UA-71865250-1', 'auto');
  ga('set', 'dimension1', 'master');
  ga('send', 'pageview');

</script>

<!-- Triggers -->
<script>
  (function () {
    function categorize(text, category) {
      ga('send', 'event', {
        eventCategory: category,
        eventAction: text,
        eventLabel: event.target.href,
        transport: 'beacon'
      });
    }

    setTimeout(function () {
      // header
      document.querySelectorAll('.clarke-header')[0].addEventListener('mousedown', function (event) {
        if (event.target.tagName.toLowerCase() === 'a') {
          ga('send', 'event', {
            eventCategory: 'Header link',
            eventAction: 'click',
            eventLabel: event.target.href,
            transport: 'beacon'
          });
        }
      });

      // content
      document.querySelectorAll('.clarke-main')[0].addEventListener('mousedown', function (event) {
        if (event.target.classList.contains("ory-content-plugin-button-text")) {
          // A button was clicked
          ga('send', 'event', {
            eventCategory: 'Content button',
            eventAction: 'click',
            eventLabel: event.target.href,
            transport: 'beacon'
          });
          categorize(event.target.textContent.toLowerCase(), 'Content button');
        } else if (event.target.tagName.toLowerCase() === 'a') {
          ga('send', 'event', {
            eventCategory: 'Content link',
            eventAction: 'click',
            eventLabel: event.target.href,
            transport: 'beacon'
          });
          categorize(event.target.textContent.toLowerCase(), 'Content link');
        }
      });


      // footer
      document.querySelectorAll('.clarke-footer')[0].addEventListener('mousedown', function (event) {
        if (event.target.tagName.toLowerCase() === 'a') {
          ga('send', 'event', {
            eventCategory: 'Footer link',
            eventAction: 'click',
            eventLabel: event.target.href,
            transport: 'beacon'
          });
        }
      });

    }, 3000)
  })()
</script>
</body>
</html>
