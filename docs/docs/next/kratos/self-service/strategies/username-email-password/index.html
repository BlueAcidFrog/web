<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Username or Email and Password · ORY Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="The `password` strategy implements the most-common used form of login and"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Username or Email and Password · ORY Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.ory.sh/"/><meta property="og:description" content="The `password` strategy implements the most-common used form of login and"/><meta property="og:image" content="https://www.ory.sh/images/logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://www.ory.sh/images/logo.png"/><link rel="shortcut icon" href="/images/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-71865250-1', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/images/logo.svg" alt="ORY Documentation"/></a><a href="/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/" target="_self">Home</a></li><li class=""><a href="/blog" target="_self">Blog</a></li><li class=""><a href="https://community.ory.sh" target="_self">Forum</a></li><li class=""><a href="/chat" target="_self">Chat</a></li><li class="siteNavGroupActive"><a href="/docs/next/" target="_self">Docs</a></li><li class=""><a href="https://github.com/ory/" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Self Service Strategies</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Welcome<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/">ORY Developer Documentation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Ecosystem<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/projects">Projects</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/software-architecture-philosophy">Software Architecture and Philosophy</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/deployment">Deployment Fundamentals and Requirements</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/versioning">Software Versions and Project Maturity</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/upgrading">Software Updates</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/api-design">API Design</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/community">Community</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/sqa">Software Quality Assurance</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Kratos<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Introduction</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/quickstart">Quickstart</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/install">Installation</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/ui-user-interface">User Interface</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/identity-user-model">Identity and User Model</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/credentials">Credentials</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/email-sms">Out-of-band communication via E-Mail and SMS</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/federation">Federation</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/security">Threat Models and Security Profiles</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Self Service Flows</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/user-login-user-registration">User Login and User Registration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/user-logout">User Logout</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/user-profile-management">Profile Management</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/password-reset-account-recovery">Account Recovery</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/user-facing-errors">User-Facing Errors</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Self Service Strategies</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/strategies/">Overview</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/next/kratos/self-service/strategies/username-email-password">Username or Email and Password</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/strategies/openid-connect-social-sign-in-oauth2">Social Sign In with OpenID Connect and OAuth2</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Self Service Jobs and Workflows</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/workflows/jobs/before">Before Jobs</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/workflows/jobs/after">After Jobs</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Reference</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/reference/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/reference/json-schema-json-paths">JSON Schema and JSON Paths</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/reference/html-forms">HTML Form Parser</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/sdk/api">REST API</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/sdk/">Overview</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Further Reading</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/further-reading/comparison">Comparison</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Hydra<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/hydra/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/install">Installation</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/oauth2">OAuth 2.0</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/login-consent-flow">Hydra workflow</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Integrating Hydra into your stack</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/5min-tutorial">5 Minute Tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/implementing-consent">Login, Consent &amp; Logout</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/case-study">OAuth 2.0 Case Study</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/configure-deploy">Installation and Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/dependencies-environment">Database Setup and Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/production">Preparing for Production</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/debugging">Debugging</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/advanced">Advanced Topics</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/integration">Consuming OAuth 2.0</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API &amp; SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/api">REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/go">Go</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/js">JavaScript</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/php">PHP</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Further Reading</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/limitations">Limitations</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/jwks">JSON Web Key Sets</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/security-architecture">Security Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/faq">FAQ</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Oathkeeper<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/install">Installation</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Core Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/api-access-rules">API Access Rules</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/pipeline/authn">Authenticators</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/pipeline/authz">Authorizers</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/pipeline/mutator">Mutators</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/pipeline/error">Error Handlers</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/configure-deploy">Configure and Deploy</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API &amp; SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/sdk/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/sdk/api">REST API</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Keto<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/keto/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/install">Installation</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/keto/configure-deploy">Configure and Deploy</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/secure">Secure</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Control Engines</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/">Access Control Engines - Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/acl">Access Control Lists (ACL)</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/rbac">Role Based Access Control (RBAC)</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/acp-ory">ORY Access Control Policies</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/acp-aws">AWS IAM Policies</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API &amp; SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/keto/sdk/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/sdk/api">REST API</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Performance<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/performance/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/performance/hydra">ORY Hydra</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/ory/docs/edit/master/docs/kratos/self-service/strategies/username-email-password.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Username or Email and Password</h1></header><article><div><span><p>The <code>password</code> strategy implements the most-common used form of login and
registration: An identifier (username, email, phone number, ...) and a password.</p>
<p>It implements several flows, specifically
<a href="/docs/next/kratos/self-service/flows/user-login-user-registration">User Login and User Registration</a>.</p>
<p>To enable the <code>password</code> strategy, set <code>selfservice.strategies.password.enabled</code>
to true in your ORY Kratos configuration:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">selfservice:</span>
  <span class="hljs-attr">strategies:</span>
    <span class="hljs-attr">password:</span>
      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
</code></pre>
<p>Passwords are hashed using the
<a href="/docs/next/kratos/concepts/security#Argon2">Argon2 Hashing Algorithm</a> which can be
configured in the
<a href="/docs/next/kratos/concepts/security#Argon2">ORY Kratos Argon2 Configuration</a>.</p>
<p>When a user signs up using this strategy, the Default Identity Traits Schema
(set using <code>identity.traits.default_schema_url</code>) is used:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">identity:</span>
  <span class="hljs-attr">traits:</span>
    <span class="hljs-comment"># also supports http(s) of course</span>
    <span class="hljs-attr">default_schema_url:</span> <span class="hljs-string">file:///path/to/default-identity.schema.json</span>
</code></pre>
<p>If you don't know what that means, please read the
<a href="/docs/next/kratos/concepts/identity-user-model">&quot;Concepts: Identity&quot; Chapter</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="choosing-between-username-email-phone-number"></a><a href="#choosing-between-username-email-phone-number" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Choosing between Username, Email, Phone Number</h2>
<p>Before you start, you need to decide what data you want to collect from your
users and why! It is hard to change this decision afterwards, so make sure
you've taken everything into account!</p>
<p>When logging in, the user will use a login identifier and a password to sign up
and in. The identifier can be</p>
<ul>
<li>a username - e.g. &quot;john.doe&quot; or &quot;johndoe123&quot; or &quot;oryuser&quot;,</li>
<li>an email address - e.g. <code>john.doe@gmail.com</code>,</li>
<li>a phone number - e.g. <code>+49-1234-4321-1234-4321</code>.</li>
</ul>
<p>All of these approaches have up- and downsides.</p>
<p>Using the email address as the login identifier is easy to remember, does not
require additional fields (because the email address is already being
collected), and is usually unique. It's usually unique because sometimes
companies use a &quot;shared&quot; email account (e.g. <a href="mailto:office@acme.org">office@acme.org</a>) to access
services. In that case, multiple real identities are using the same email
identifier to log in.</p>
<p>The email address however represents a unique identifier and personally
identifiable information (PII). An attacker could for example check if an email
address (e.g. <code>john.doe@gmail.com</code>) is registered at a site (e.g. an adult
website) and use that information for blackmail (see
<a href="/docs/next/kratos/concepts/security#account-enumeration-attacks">Account Enumeration Attacks</a>).</p>
<p>The same considerations apply to using a phone number as the primary
registration &amp; login identifier.</p>
<p>Using a free text username reduces the privacy risk because it is much harder to
make a connection between the username and a real world identity. It's still
possible in cases where users choose a username such as
&quot;john.doe.from.mineapolis.1970&quot;, but finding the right username identifier is
still difficult and there is plausible deniability because anyone could use that
username.</p>
<p>A free text username however requires capturing additional fields (e.g. an email
address for password resets / account recovery) and is hard to remember. It is
often very difficult to find unique usernames as people tend to use a
combination of their names and initials (e.g. <code>john.doe</code>) which has a high
chance of collision. Therefore, one ends up with usernames such as
<code>john.doe1234432</code>.</p>
<p>It is important to understand that ORY Kratos lowercases all <code>password</code>
identifiers and therefore E-Mail addresses. Characters <code>+</code> or <code>.</code> which have
special meaning for some E-Mail Providers (e.g. GMail) are not normalized:</p>
<ul>
<li><code>userNAME</code> is equal to <code>username</code></li>
<li><code>foo@BaR.com</code> is equal to <code>foo@bar.com</code></li>
<li><code>foo+baz@bar.com</code> is NOT equal to <code>foo@bar.com</code></li>
<li><code>foo.baz@bar.com</code> is NOT equal to <code>foobar@bar.com</code></li>
</ul>
<p>You need to decide which route you want to take.</p>
<h3><a class="anchor" aria-hidden="true" id="email-and-password"></a><a href="#email-and-password" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Email and Password</h3>
<p>To use the email address as the login identifier, define the following Identity
Traits Schema:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"https://example.com/registration.schema.json"</span>,
  <span class="hljs-attr">"$schema"</span>: <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span>,
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Person"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">"properties"</span>: {
    <span class="hljs-attr">"email"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-attr">"format"</span>: <span class="hljs-string">"email"</span>,
      <span class="hljs-attr">"ory.sh/kratos"</span>: {
        <span class="hljs-attr">"credentials"</span>: {
          <span class="hljs-attr">"password"</span>: {
            <span class="hljs-attr">"identifier"</span>: <span class="hljs-literal">true</span>
          }
        }
      }
    }
  }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="multiple-e-mails-and-password"></a><a href="#multiple-e-mails-and-password" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Multiple E-Mails and Password</h3>
<p>You can allow users to sign up with multiple E-Mail Addresses and use any of
those for log in:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"https://example.com/registration.schema.json"</span>,
  <span class="hljs-attr">"$schema"</span>: <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span>,
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Person"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">"properties"</span>: {
    <span class="hljs-attr">"emails"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"array"</span>,
      <span class="hljs-attr">"items"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
        <span class="hljs-attr">"format"</span>: <span class="hljs-string">"email"</span>,
        <span class="hljs-attr">"ory.sh/kratos"</span>: {
          <span class="hljs-attr">"credentials"</span>: {
            <span class="hljs-attr">"password"</span>: {
              <span class="hljs-attr">"identifier"</span>: <span class="hljs-literal">true</span>
            }
          }
        }
      }
    }
  }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="username-and-password"></a><a href="#username-and-password" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Username and Password</h3>
<p>To use a username as the login identifier, define the following Identity Traits
Schema:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"https://example.com/registration.schema.json"</span>,
  <span class="hljs-attr">"$schema"</span>: <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span>,
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Person"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">"properties"</span>: {
    <span class="hljs-attr">"email"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-attr">"format"</span>: <span class="hljs-string">"email"</span>,
      <span class="hljs-attr">"ory.sh/kratos"</span>: {
        <span class="hljs-attr">"credentials"</span>: {
          <span class="hljs-attr">"password"</span>: {
            <span class="hljs-attr">"identifier"</span>: <span class="hljs-literal">true</span>
          }
        }
      }
    }
  }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="username-and-email-and-password"></a><a href="#username-and-email-and-password" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Username and Email and Password</h3>
<p>You may also mix usernames and passwords:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"https://example.com/registration.schema.json"</span>,
  <span class="hljs-attr">"$schema"</span>: <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span>,
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Person"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">"properties"</span>: {
    <span class="hljs-attr">"email"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-attr">"format"</span>: <span class="hljs-string">"email"</span>,
      <span class="hljs-attr">"ory.sh/kratos"</span>: {
        <span class="hljs-attr">"credentials"</span>: {
          <span class="hljs-attr">"password"</span>: {
            <span class="hljs-attr">"identifier"</span>: <span class="hljs-literal">true</span>
          }
        }
      }
    },
    <span class="hljs-attr">"username"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-attr">"ory.sh/kratos"</span>: {
        <span class="hljs-attr">"credentials"</span>: {
          <span class="hljs-attr">"password"</span>: {
            <span class="hljs-attr">"identifier"</span>: <span class="hljs-literal">true</span>
          }
        }
      }
    }
  }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="phone-number-and-password"></a><a href="#phone-number-and-password" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Phone Number And Password</h3>
<blockquote>
<p>This will be addressed in a future release and is tracked as
<a href="https://github.com/ory/kratos/issues/137">kratos#137</a>.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="browser-clients"></a><a href="#browser-clients" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Browser Clients</h2>
<h3><a class="anchor" aria-hidden="true" id="registration"></a><a href="#registration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Registration</h3>
<p>This strategy uses the high-level registration flow defined in chapter
<a href="/docs/next/kratos/self-service/flows/user-login-user-registration">Self-Service Registration User Flow</a>.</p>
<p>Once the user is redirected to the Registration UI URL, the endpoint responsible
for that URL makes a request to ORY Kratos' Public / Admin API and appends the
<code>request</code> query parameter.</p>
<p>ORY Kratos uses the JSON Schema defined in <code>identity.traits.default_schema_url</code>
to generate a list of form fields and add it to the Registration Request.</p>
<p>Using a JSON Schema like</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"$id"</span>: <span class="hljs-string">"https://schemas.ory.sh/presets/kratos/quickstart/email-password/identity.schema.json"</span>,
  <span class="hljs-attr">"$schema"</span>: <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span>,
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Person"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">"properties"</span>: {
    <span class="hljs-attr">"email"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
      <span class="hljs-attr">"format"</span>: <span class="hljs-string">"email"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"E-Mail"</span>,
      <span class="hljs-attr">"minLength"</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">"ory.sh/kratos"</span>: {
        <span class="hljs-attr">"credentials"</span>: {
          <span class="hljs-attr">"password"</span>: {
            <span class="hljs-attr">"identifier"</span>: <span class="hljs-literal">true</span>
          }
        }
      }
    },
    <span class="hljs-attr">"name"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"first"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>
        },
        <span class="hljs-attr">"last"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>
        }
      }
    }
  },
  <span class="hljs-attr">"required"</span>: [<span class="hljs-string">"email"</span>],
  <span class="hljs-attr">"additionalProperties"</span>: <span class="hljs-literal">false</span>
}
</code></pre>
<p>will result in the following Registration Request</p>
<pre><code class="hljs css language-json5">{
  <span class="hljs-attribute">id</span>: <span class="hljs-string">'713df601-d6c8-4331-8195-c29b92db459f'</span>,
  <span class="hljs-attribute">expires_at</span>: <span class="hljs-string">'2020-01-27T16:31:00.3507956Z'</span>,
  <span class="hljs-attribute">issued_at</span>: <span class="hljs-string">'2020-01-27T16:21:00.3508076Z'</span>,
  <span class="hljs-attribute">request_url</span>: <span class="hljs-string">'http://127.0.0.1:4455/auth/browser/registration'</span>,
  <span class="hljs-attribute">methods</span>: {
    <span class="hljs-attribute">password</span>: {
      <span class="hljs-attribute">method</span>: <span class="hljs-string">'password'</span>,
      <span class="hljs-attribute">config</span>: {
        <span class="hljs-attribute">action</span>: <span class="hljs-string">'http://127.0.0.1:4455/.ory/kratos/public/auth/browser/methods/password/registration?request=713df601-d6c8-4331-8195-c29b92db459f'</span>,
        <span class="hljs-attribute">method</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-attribute">fields</span>: [
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'csrf_token'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'hidden'</span>,
            <span class="hljs-attribute">required</span>: true,
            <span class="hljs-attribute">value</span>: <span class="hljs-string">'0klCuilgIO2k0Ev3J3IEsMOlmxg0RhjiiiWXVKm3Pd7HxZLVkDHWoOSfiT+/BJn69Dg2fmq6MHv8HkEx6MrVlw=='</span>,
          },
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'traits.email'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'email'</span>,
            <span class="hljs-attribute">required</span>: true,
          },
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'password'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'password'</span>,
            <span class="hljs-attribute">required</span>: true,
          },
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'traits.name.first'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'text'</span>,
          },
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'traits.name.last'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'text'</span>,
          },
        ],
      },
    },
  },
}
</code></pre>
<p>which in turn is easily to render by filling out a HTML Form template:</p>
<pre><code class="hljs css language-html">&lt;form method="{{ method }}" action="{{ action }}"&gt;
  &lt;!-- repeat this for every field --&gt;
  &lt;input type="{{ field.type }}" name="{{ field.name }} required="{{
  field.required }}" value="{{ field.value }}"
  &lt;!-- ... --&gt;&gt;

  &lt;input type="submit" value="Create account" /&gt;
&lt;/form&gt;
</code></pre>
<p>Once the user clicks &quot;Create Account&quot;, the payload will be sent to ORY Kratos'
Public API. The data will be validated against the JSON Schema (e.g. checking if
a required field is missing, if some condition like <code>minLength</code> is not
fulfilled, ...). If the data is invalid or incomplete, the browser will be
redirected to the same login endpoint with the same request ID. When fetching
that request ID again, error details will be included in the JSON Response, such
as:</p>
<pre><code class="hljs css language-json5">{
  <span class="hljs-attribute">id</span>: <span class="hljs-string">'713df601-d6c8-4331-8195-c29b92db459f'</span>,
  <span class="hljs-attribute">expires_at</span>: <span class="hljs-string">'2020-01-27T16:31:00.3507956Z'</span>,
  <span class="hljs-attribute">issued_at</span>: <span class="hljs-string">'2020-01-27T16:21:00.3508076Z'</span>,
  <span class="hljs-attribute">request_url</span>: <span class="hljs-string">'http://127.0.0.1:4455/auth/browser/registration'</span>,
  <span class="hljs-attribute">methods</span>: {
    <span class="hljs-attribute">password</span>: {
      <span class="hljs-attribute">method</span>: <span class="hljs-string">'password'</span>,
      <span class="hljs-attribute">config</span>: {
        <span class="hljs-attribute">errors</span>: [
          {
            <span class="hljs-attribute">message</span>: <span class="hljs-string">'Please update the Form Fields to proceed.'</span>,
          },
        ],
        <span class="hljs-attribute">action</span>: <span class="hljs-string">'http://127.0.0.1:4455/.ory/kratos/public/auth/browser/methods/password/registration?request=713df601-d6c8-4331-8195-c29b92db459f'</span>,
        <span class="hljs-attribute">method</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-attribute">fields</span>: [
          <span class="hljs-comment">/* ... */</span>
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'password'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'text'</span>,
            <span class="hljs-attribute">value</span>: <span class="hljs-string">'t4aegbydfv5234'</span>,
            <span class="hljs-attribute">errors</span>: [
              {
                <span class="hljs-attribute">message</span>: <span class="hljs-string">"traits.email: Does not match format 'email'"</span>,
              },
            ],
          },
          <span class="hljs-comment">/* ... */</span>
        ],
      },
    },
  },
}
</code></pre>
<blockquote>
<p>Validation error messages and context will be improved in future releases.
This is tracked as <a href="https://github.com/ory/kratos/issues/185">kratos#185</a>.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="login"></a><a href="#login" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Login</h3>
<p>The Login flow is almost identical to the registration flow. The only difference
is that only three fields will be requested:</p>
<pre><code class="hljs css language-json5">{
  <span class="hljs-attribute">id</span>: <span class="hljs-string">'0cfb0f7e-3866-453c-9c23-28cc2cb7fead'</span>,
  <span class="hljs-attribute">expires_at</span>: <span class="hljs-string">'2020-01-27T16:48:53.8826084Z'</span>,
  <span class="hljs-attribute">issued_at</span>: <span class="hljs-string">'2020-01-27T16:38:53.8826392Z'</span>,
  <span class="hljs-attribute">request_url</span>: <span class="hljs-string">'http://127.0.0.1:4455/auth/browser/login'</span>,
  <span class="hljs-attribute">methods</span>: {
    <span class="hljs-attribute">password</span>: {
      <span class="hljs-attribute">method</span>: <span class="hljs-string">'password'</span>,
      <span class="hljs-attribute">config</span>: {
        <span class="hljs-attribute">action</span>: <span class="hljs-string">'http://127.0.0.1:4455/.ory/kratos/public/auth/browser/methods/password/login?request=0cfb0f7e-3866-453c-9c23-28cc2cb7fead'</span>,
        <span class="hljs-attribute">method</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-attribute">fields</span>: [
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'csrf_token'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'hidden'</span>,
            <span class="hljs-attribute">required</span>: true,
            <span class="hljs-attribute">value</span>: <span class="hljs-string">'F0LABRxm/os+18VBUcbmz98LkJid1sEj++4X41rcdbcCzhBqpTcIxn6YB4nJsHuF6JY9/sMq6bqN1cGGG6Gd/g=='</span>,
          },
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'identifier'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'text'</span>,
            <span class="hljs-attribute">required</span>: true,
          },
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'password'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'password'</span>,
            <span class="hljs-attribute">required</span>: true,
          },
        ],
      },
    },
  },
}
</code></pre>
<p>If the login form is filled out incorrectly, errors are included in the
response:</p>
<pre><code class="hljs css language-json5">{
  <span class="hljs-attribute">id</span>: <span class="hljs-string">'0cfb0f7e-3866-453c-9c23-28cc2cb7fead'</span>,
  <span class="hljs-attribute">expires_at</span>: <span class="hljs-string">'2020-01-27T16:48:53.8826084Z'</span>,
  <span class="hljs-attribute">issued_at</span>: <span class="hljs-string">'2020-01-27T16:38:53.8826392Z'</span>,
  <span class="hljs-attribute">request_url</span>: <span class="hljs-string">'http://127.0.0.1:4455/auth/browser/login'</span>,
  <span class="hljs-attribute">methods</span>: {
    <span class="hljs-attribute">password</span>: {
      <span class="hljs-attribute">method</span>: <span class="hljs-string">'password'</span>,
      <span class="hljs-attribute">config</span>: {
        <span class="hljs-attribute">errors</span>: [
          {
            <span class="hljs-attribute">message</span>: <span class="hljs-string">'Please check the data you provided.'</span>,
          },
        ],
        <span class="hljs-attribute">action</span>: <span class="hljs-string">'http://127.0.0.1:4455/.ory/kratos/public/auth/browser/methods/password/login?request=0cfb0f7e-3866-453c-9c23-28cc2cb7fead'</span>,
        <span class="hljs-attribute">method</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-attribute">fields</span>: [
          <span class="hljs-comment">/* ... */</span>
          {
            <span class="hljs-attribute">name</span>: <span class="hljs-string">'password'</span>,
            <span class="hljs-attribute">type</span>: <span class="hljs-string">'password'</span>,
            <span class="hljs-attribute">required</span>: true,
            <span class="hljs-attribute">errors</span>: [
              {
                <span class="hljs-attribute">message</span>: <span class="hljs-string">'password: password is required'</span>,
              },
            ],
          },
        ],
      },
    },
  },
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="api-clients"></a><a href="#api-clients" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API Clients</h2>
<p>API-based login and registration using this strategy will be addressed in a
future release of ORY Kratos.</p>
<h2><a class="anchor" aria-hidden="true" id="security-and-defenses"></a><a href="#security-and-defenses" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Security and Defenses</h2>
<p>Password-based authentication flows are subject to frequent abuse through</p>
<ul>
<li>Social Engineering Attacks;</li>
<li>Password Guessing Attacks;</li>
<li>Phishing Attacks.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="anti-automation"></a><a href="#anti-automation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Anti-automation</h3>
<blockquote>
<p>This feature is a work in progress and is tracked as
<a href="https://github.com/ory/kratos/issues/138">kratos#133</a>.</p>
</blockquote>
<p>Actions that cause out-of-band communications, such as sending an activation
link via email or an activation code via SMS, can be abused by automated
systems. The goal of such an attack is to send out so many emails or SMS, that
your reputation worsens (spam filters) or you're faced with massive costs
(carrier fees).</p>
<p>CAPTCHA renders these attacks either very difficult or impossible. ORY Kratos
has CAPTCHA support built-in. ORY Kratos will prompt the user to complete a
CAPTCHA in the following scenarios:</p>
<ul>
<li>The user tries to register more than one account within 72 hours.</li>
<li>The user failed provide valid credentials for the third time within 12 hours.</li>
<li>The user tries to recover their account for the second time within 72 hours.</li>
</ul>
<p>For integration guidelines, please check the individual flow's (registration,
login, account recovery) integration documentation.</p>
<h3><a class="anchor" aria-hidden="true" id="password-validation"></a><a href="#password-validation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Password Validation</h3>
<blockquote>
<p>Further improvements are work in progress and are tracked on
<a href="https://github.com/ory/kratos/issues?q=is%3Aopen+label%3Amodule%3Ass%2Fpassword+">GitHub</a></p>
</blockquote>
<p>To prevent weak passwords ORY Kratos implements different measures. Users often
choose passwords similar to their traits. To prevent this ORY Kratos ensures
there is a sufficient
<a href="https://en.wikipedia.org/wiki/Levenshtein_distance">Levenshtein-Distance</a> (aka
&quot;Edit-Distance&quot;) between the identifier and the password. It also makes sure
that the identifier and password have a small enough longest common substring.</p>
<p>Furthermore the <code>password</code> strategy comes with a build-in check against the
<a href="https://haveibeenpwned.com">&quot;Have I been pwned&quot;</a> breach database. This way ORY
Kratos makes sure your users cannot use passwords like &quot;password&quot;, &quot;123456&quot; or
any other commonly used one. To protect the value of the password the
<a href="https://haveibeenpwned.com/API/v3#SearchingPwnedPasswordsByRange">range API</a> is
being used.</p>
<h3><a class="anchor" aria-hidden="true" id="account-enumeration-defenses-work-in-progress"></a><a href="#account-enumeration-defenses-work-in-progress" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Account Enumeration Defenses (work in progress)</h3>
<blockquote>
<p>This feature is a work in progress and is tracked as
<a href="https://github.com/ory/kratos/issues/133">kratos#133</a>.</p>
</blockquote>
<p>Account enumeration attacks allow a attacker to find out who is signed up. This
compromises the privacy of your users and can hurt reputation depending on the
service (e.g. &quot;adult content&quot;).</p>
<p>This attack usually makes only sense if an email address or a phone number is
collected during registration. For chosen usernames, this attack is much more
difficult, as the attacker has to know what usernames the victim is using.</p>
<p>There are three common ways an attacker can figure out if a user is signed up at
a service:</p>
<ul>
<li>During login: &quot;No user with this email address was found&quot;</li>
<li>During registration: &quot;A user with this email address exists already&quot;</li>
<li>During password reset: &quot;No user with this email address was found&quot;</li>
</ul>
<p>To mitigate this attack, the following strategies need to be deployed:</p>
<ul>
<li>The login form should return the same message regardless of whether the
password is wrong or the email/username does not exist: &quot;The provided
credentials are invalid.&quot;</li>
<li>The password reset form should always return a success message and send out an
email. If the email address is registered, a normal password reset email is
sent. If the email address is not registered, an email is sent to the address
indicating that no account is set up with that email address. This is helpful
to users that have multiple email addresses and are using the wrong email
address for the password reset.</li>
<li>The registration form should also always return a success message and send out
an email. If the email address is not yet registered, a regular &quot;account
activation&quot; email is sent out. If the email address is registered already, a
email is sent out telling the user that the account is already set up, and
link to the login screen.</li>
</ul>
<p>If you wish to mitigate account enumeration attacks, it is important to note
that you can not sign in users directly after sign up! Depending on the type of
service you provide, you might not care about this specific attack in which case
direct login after sign up would be ok.</p>
<h4><a class="anchor" aria-hidden="true" id="enabling-account-enumeration-defenses"></a><a href="#enabling-account-enumeration-defenses" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enabling Account Enumeration Defenses</h4>
<p>Assuming you wish to enable account enumeration defenses, you need to configure
ORY Kratos as follows:</p>
<ul>
<li>Collect one or more email addresses during sign up and enable email
verification.</li>
<li><strong>Do not</strong> enable the <code>session</code> post-registration workflow. Use only the
<code>redirect</code> post-registration workflow.</li>
</ul>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">selfservice:</span>
  <span class="hljs-attr">registration:</span>
    <span class="hljs-attr">after:</span>
      <span class="hljs-attr">password:</span>
        <span class="hljs-comment"># !! DO NOT enable `session` or all registration processes will fail!!</span>
        <span class="hljs-comment"># - run: session</span>

        <span class="hljs-comment"># You **must** enable identifier verification or no email will be sent and the registration is thus just a blank</span>
        <span class="hljs-comment"># entry in the database with no way of logging in.</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">verify</span>

        <span class="hljs-comment"># You **must** enable redirection. The page should show a message such as: "Registration complete, please</span>
        <span class="hljs-comment"># check your email for further steps". The user will be redirected to this page regardless of the registration</span>
        <span class="hljs-comment"># status (success, invalid).</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">redirect</span>
          <span class="hljs-attr">config:</span>
            <span class="hljs-attr">default_redirect_url:</span> <span class="hljs-string">http://test.kratos.ory.sh:4000/registration_next_steps</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="disable-account-enumeration-defenses"></a><a href="#disable-account-enumeration-defenses" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Disable Account Enumeration Defenses</h4>
<p>Enforcing email verification, which requires an email round trip and disrupts
the sign up process, is not always feasible. In these cases, you might want to
disable account enumeration defenses.</p>
<p>You can disable the defense mechanism on a per-field basis in your Identity
Traits Schema:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-string">{</span>
  <span class="hljs-string">'$id'</span><span class="hljs-string">:</span> <span class="hljs-string">'https://example.com/registration.schema.json'</span><span class="hljs-string">,</span>
  <span class="hljs-string">'$schema'</span><span class="hljs-string">:</span> <span class="hljs-string">'http://json-schema.org/draft-07/schema#'</span><span class="hljs-string">,</span>
  <span class="hljs-attr">'title':</span> <span class="hljs-string">'Person'</span><span class="hljs-string">,</span>
  <span class="hljs-attr">'type':</span> <span class="hljs-string">'object'</span><span class="hljs-string">,</span>
  <span class="hljs-attr">'properties':</span>
    <span class="hljs-string">{</span>
      <span class="hljs-attr">'username':</span>
        <span class="hljs-string">{</span>
          <span class="hljs-attr">'type':</span> <span class="hljs-string">'string'</span><span class="hljs-string">,</span>
          <span class="hljs-attr">'ory.sh/kratos':</span>
            <span class="hljs-string">{</span>
              <span class="hljs-attr">'credentials':</span>
                <span class="hljs-string">{</span>
                  <span class="hljs-attr">'password':</span>
                    <span class="hljs-string">{</span>
                      <span class="hljs-attr">'identifier':</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span>
                      <span class="hljs-attr">'disable_account_enumeration_defenses':</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span>
                    <span class="hljs-string">},</span>
                <span class="hljs-string">},</span>
            <span class="hljs-string">},</span>
        <span class="hljs-string">},</span>
    <span class="hljs-string">},</span>
<span class="hljs-string">}</span>
</code></pre>
<p>This will tell ORY Kratos to display messages such as &quot;a user with this email
address exists already&quot; and &quot;no user with this email address is registered on
this site&quot;. You can then enable the <code>session</code> post-registration workflow:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">selfservice:</span>
  <span class="hljs-attr">registration:</span>
    <span class="hljs-attr">after:</span>
      <span class="hljs-attr">password:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">session</span>

        <span class="hljs-comment"># You can optionally enable verification of the provided email address(es) or phone number(s)</span>
        <span class="hljs-comment"># - run: verify</span>

        <span class="hljs-comment"># You may now directly redirect to e.g. the dashboard:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">redirect</span>
          <span class="hljs-attr">config:</span>
            <span class="hljs-attr">default_redirect_url:</span> <span class="hljs-string">http://test.kratos.ory.sh:4000/dashboard</span>
</code></pre>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 2/6/2020 by Patrik</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/next/kratos/self-service/strategies/index"><span class="arrow-prev">← </span><span>Overview</span></a><a class="docs-next button" href="/docs/next/kratos/self-service/strategies/openid-connect-social-sign-in-oauth2"><span class="function-name-prevnext">Social Sign In with OpenID Connect and OAuth2</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#choosing-between-username-email-phone-number">Choosing between Username, Email, Phone Number</a><ul class="toc-headings"><li><a href="#email-and-password">Email and Password</a></li><li><a href="#multiple-e-mails-and-password">Multiple E-Mails and Password</a></li><li><a href="#username-and-password">Username and Password</a></li><li><a href="#username-and-email-and-password">Username and Email and Password</a></li><li><a href="#phone-number-and-password">Phone Number And Password</a></li></ul></li><li><a href="#browser-clients">Browser Clients</a><ul class="toc-headings"><li><a href="#registration">Registration</a></li><li><a href="#login">Login</a></li></ul></li><li><a href="#api-clients">API Clients</a></li><li><a href="#security-and-defenses">Security and Defenses</a><ul class="toc-headings"><li><a href="#anti-automation">Anti-automation</a></li><li><a href="#password-validation">Password Validation</a></li><li><a href="#account-enumeration-defenses-work-in-progress">Account Enumeration Defenses (work in progress)</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2020 ORY GmbH</section><div id="codefund"></div><script src="https://codefund.io/properties/140/funder.js" async=""></script><script>(function () {
  document.querySelectorAll('.tabs .tabs-nav .nav-item a').forEach(function (t) {
    t.addEventListener("click", function (e) {
      e.preventDefault();

      t.closest('.tabs-nav').querySelectorAll('.nav-item a').forEach(function (i) {
        i.classList.remove('active');
      });

      t.closest('.tabs').querySelectorAll('.tab-content .tab-pane').forEach(function (i) {
        i.classList.remove('active');
      });

      t.classList.add('active');
      document.getElementById(t.href.split('#')[1]).classList.add('active');
      return false
    });
  });
})();</script></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '8463c6ece843b377565726bb4ed325b0',
                indexName: 'ory',
                inputSelector: '#search_input_react'
              });
            </script></body></html>