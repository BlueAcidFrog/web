<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Identity and User Model · ORY Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="An identity (&quot;user&quot;, &quot;user account&quot;, &quot;account&quot;, &quot;subject&quot;) is the &quot;who&quot; of a"/><meta name="docsearch:version" content="oryOS.18"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Identity and User Model · ORY Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.ory.sh/"/><meta property="og:description" content="An identity (&quot;user&quot;, &quot;user account&quot;, &quot;account&quot;, &quot;subject&quot;) is the &quot;who&quot; of a"/><meta property="og:image" content="https://www.ory.sh/images/logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://www.ory.sh/images/logo.png"/><link rel="shortcut icon" href="/images/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-71865250-1', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/images/logo.svg" alt="ORY Documentation"/></a><a href="/versions"><h3>oryOS.18</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/" target="_self">Home</a></li><li class=""><a href="/blog" target="_self">Blog</a></li><li class=""><a href="https://community.ory.sh" target="_self">Forum</a></li><li class=""><a href="/chat" target="_self">Chat</a></li><li class="siteNavGroupActive"><a href="/docs/" target="_self">Docs</a></li><li class=""><a href="https://github.com/ory/" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Concepts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Welcome<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/">ORY Developer Documentation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Ecosystem<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/ecosystem/projects">Projects</a></li><li class="navListItem"><a class="navItem" href="/docs/ecosystem/software-architecture-philosophy">Software Architecture and Philosophy</a></li><li class="navListItem"><a class="navItem" href="/docs/ecosystem/deployment">Deployment Fundamentals and Requirements</a></li><li class="navListItem"><a class="navItem" href="/docs/ecosystem/configuring">Configuring ORY services</a></li><li class="navListItem"><a class="navItem" href="/docs/ecosystem/versioning">Software Versions and Project Maturity</a></li><li class="navListItem"><a class="navItem" href="/docs/ecosystem/upgrading">Software Updates</a></li><li class="navListItem"><a class="navItem" href="/docs/ecosystem/api-design">API Design</a></li><li class="navListItem"><a class="navItem" href="/docs/ecosystem/community">Community</a></li><li class="navListItem"><a class="navItem" href="/docs/ecosystem/roadmap">Roadmap</a></li><li class="navListItem"><a class="navItem" href="/docs/ecosystem/sqa">Software Quality Assurance</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Kratos<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Introduction</h4><ul><li class="navListItem"><a class="navItem" href="/docs/kratos/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/quickstart">Quickstart</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/install">Installation</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/kratos/concepts/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/concepts/ui-user-interface">User Interface</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/kratos/concepts/identity-user-model">Identity and User Model</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/concepts/credentials">Credentials</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/concepts/email-sms">Out-of-band communication via E-Mail and SMS</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/concepts/federation">Federation</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/concepts/security">Threat Models and Security Profiles</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Self Service Flows</h4><ul><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/flows/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/flows/user-login-user-registration">User Login and User Registration</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/flows/user-logout">User Logout</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/flows/user-profile-management">Profile Management</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/flows/password-reset-account-recovery">Account Recovery</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/flows/user-facing-errors">User-Facing Errors</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/flows/verify-email-account-activation">Email and Phone Verification and Account Activation</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Self Service Strategies</h4><ul><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/strategies/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/strategies/username-email-password">Username or Email and Password</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/strategies/openid-connect-social-sign-in-oauth2">Social Sign In with OpenID Connect and OAuth2</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Self Service Jobs and Workflows</h4><ul><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/workflows/jobs/before">Before Jobs</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/self-service/workflows/jobs/after">After Jobs</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Reference</h4><ul><li class="navListItem"><a class="navItem" href="/docs/kratos/reference/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/reference/json-schema-json-paths">JSON Schema and JSON Paths</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/reference/html-forms">HTML Form Parser</a></li><li class="navListItem"><a class="navItem" href="/docs/kratos/sdk/api">REST API</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/kratos/sdk/">Overview</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Further Reading</h4><ul><li class="navListItem"><a class="navItem" href="/docs/kratos/further-reading/comparison">Comparison</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Hydra<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/hydra/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/install">Installation</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/hydra/oauth2">OAuth 2.0</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/login-consent-flow">Hydra workflow</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Integrating Hydra into your stack</h4><ul><li class="navListItem"><a class="navItem" href="/docs/hydra/5min-tutorial">5 Minute Tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/implementing-consent">Login, Consent &amp; Logout</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/case-study">OAuth 2.0 Case Study</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/hydra/configure-deploy">Installation and Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/dependencies-environment">Database Setup and Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/production">Preparing for Production</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/debugging">Debugging</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/advanced">Advanced Topics</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/integration">Consuming OAuth 2.0</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API &amp; SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/hydra/sdk/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/sdk/api">REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/sdk/go">Go</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/sdk/js">JavaScript</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/sdk/php">PHP</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Further Reading</h4><ul><li class="navListItem"><a class="navItem" href="/docs/hydra/limitations">Limitations</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/jwks">JSON Web Key Sets</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/security-architecture">Security Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/hydra/faq">FAQ</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Oathkeeper<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/install">Installation</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Core Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/api-access-rules">API Access Rules</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Pipeline Handlers</h4><ul><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/pipeline/">Access Rule Pipeline</a></li><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/pipeline/authn">Authenticators</a></li><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/pipeline/authz">Authorizers</a></li><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/pipeline/mutator">Mutators</a></li><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/pipeline/error">Error Handlers</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/configure-deploy">Configure and Deploy</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API &amp; SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/sdk/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/oathkeeper/sdk/api">REST API</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Keto<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/keto/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/keto/install">Installation</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/keto/configure-deploy">Configure and Deploy</a></li><li class="navListItem"><a class="navItem" href="/docs/keto/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/keto/secure">Secure</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Control Engines</h4><ul><li class="navListItem"><a class="navItem" href="/docs/keto/engines/">Access Control Engines - Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/keto/engines/acl">Access Control Lists (ACL)</a></li><li class="navListItem"><a class="navItem" href="/docs/keto/engines/rbac">Role Based Access Control (RBAC)</a></li><li class="navListItem"><a class="navItem" href="/docs/keto/engines/acp-ory">ORY Access Control Policies</a></li><li class="navListItem"><a class="navItem" href="/docs/keto/engines/acp-aws">AWS IAM Policies</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API &amp; SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/keto/sdk/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/keto/sdk/api">REST API</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Performance<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/performance/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/performance/hydra">ORY Hydra</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/ory/docs/edit/master/docs/kratos/concepts/identity-user-model.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Identity and User Model</h1></header><article><div><span><p>An identity (&quot;user&quot;, &quot;user account&quot;, &quot;account&quot;, &quot;subject&quot;) is the &quot;who&quot; of a
software system. It can be a customer, an employee, a user, a contractor, and
even a programmatic identity such as an IoT device, an application, or some
other type of &quot;robot.&quot;</p>
<p>Identities take different roles sometimes for instance called &quot;Account Recovery&quot;
or &quot;User Account&quot; since these are commonly used terms. In ORY Kratos an identity
is always called an &quot;Identity,&quot; and it always exposed as <code>identity</code> in the API
Endpoints, request and response payloads.</p>
<p>The following examples uses YAML for improved readability. However the API
payload is usually in JSON format. An `identity has the following properties:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># A universally unique ID that is generated when the identity is created and that cannot be changed or updated</span>
<span class="hljs-comment"># at a later stage.</span>
<span class="hljs-attr">id:</span> <span class="hljs-string">'9f425a8d-7efc-4768-8f23-7647a74fdf13'</span>

<span class="hljs-comment"># This section represents all the credentials associated with this identity. It is further explained in section "Credentials".</span>
<span class="hljs-attr">credentials:</span>
  <span class="hljs-attr">password:</span>
    <span class="hljs-attr">id:</span> <span class="hljs-string">password</span>
    <span class="hljs-attr">identifiers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">john.doe@acme.com</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">johnd@ory.sh</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">hashed_password:</span> <span class="hljs-string">...</span>
  <span class="hljs-attr">oidc:</span>
    <span class="hljs-attr">id:</span> <span class="hljs-string">oidc</span>
    <span class="hljs-attr">identifiers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">google:j8kf7a3...</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">facebook:83475891...</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">provider:</span> <span class="hljs-string">google</span>
        <span class="hljs-attr">identifier:</span> <span class="hljs-string">j8kf7a3</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">provider:</span> <span class="hljs-string">facebook</span>
        <span class="hljs-attr">identifier:</span> <span class="hljs-number">83475891</span>

<span class="hljs-comment"># This is the JSON Schema ID used for validating the identities's traits.</span>
<span class="hljs-attr">traits_schema_id:</span> <span class="hljs-string">default</span>
<span class="hljs-comment"># Could also be another schema:</span>
<span class="hljs-comment"># traits_schema_id: customer</span>

<span class="hljs-comment"># Traits represent information about the identity, such as the first or last name. The traits content is completely</span>
<span class="hljs-comment"># up to you and will be validated using the JSON Schema at `traits_schema_url`.</span>
<span class="hljs-attr">traits:</span>
  <span class="hljs-comment"># These are just examples</span>
  <span class="hljs-attr">email:</span> <span class="hljs-string">office@ory.sh</span>
  <span class="hljs-attr">name:</span>
    <span class="hljs-attr">first:</span> <span class="hljs-string">Aeneas</span>
    <span class="hljs-attr">last:</span> <span class="hljs-string">Rekkas</span>
  <span class="hljs-attr">favorite_animal:</span> <span class="hljs-string">Dog</span>
  <span class="hljs-attr">accepted_tos:</span> <span class="hljs-literal">true</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="identity-traits-and-json-schemas"></a><a href="#identity-traits-and-json-schemas" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Identity Traits and JSON Schemas</h2>
<p>An identity may have one or more traits. Traits can be modified by the identity
itself e.g. as part of the registration or profile update process as well as
anyone having access to ORY Krato's Admin API.</p>
<p>Traits tell ORY Kratos that a field has a particular meaning. For example, trait
<code>email</code> is a good candidate for the field &quot;Email + Password&quot; for signing up or
logging in.</p>
<p>To validate traits Ory Kratos uses
<a href="https://json-schema.org/learn/getting-started-step-by-step.html">JSON Schema</a>
adding a small extension &quot;Vocabulary&quot; that allows you to tell ORY Kratos that a
specific trait adds some specific meaning to the standard JSON Schema .</p>
<p>Each identity can, theoretically, have a different Traits Schema. This is useful
in the following situations:</p>
<ul>
<li>there is more than one type of identity in the system for instance customers,
support or staff;</li>
<li>the system includes both users and robots sometimes also known as named
service accounts;</li>
<li>the system needs to ingest another company's identity model, and</li>
<li>the system's identity model changes or grows over time and requires
versioning.</li>
</ul>
<p>The following example illustrates a usage scenario with three types of
identities: Regular customers,
<a href="https://en.wikipedia.org/wiki/Grandfather_clause">grandfather accounts</a>, and
Service Accounts (Microsoft provides
<a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/service-accounts">Service Accounts</a>).
There would be one JSON Schema per type of identity:</p>
<ul>
<li>Customers: <code>http://mydomain.com/schemas/v1/customer.schema.json</code></li>
<li>Grandfather Accounts: <code>http://mydomain.com/schemas/v2/customer.schema.json</code></li>
<li>Service Accounts: <code>http://mydomain.com/schemas/service-account.schema.json</code></li>
</ul>
<p>ORY Kratos expects the JSON Schemas in its configuration file:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">identity:</span>
  <span class="hljs-attr">traits:</span>
    <span class="hljs-comment"># This will be the default JSON Schema. If  `traits_schema_id` is empty when creating an identity using the</span>
    <span class="hljs-comment"># Admin API, or a user signs up using a selfservice flow, this schema will be used.</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># This is a required configuration field!</span>
    <span class="hljs-attr">default_schema_url:</span> <span class="hljs-string">http://foo.bar.com/person.schema.json</span>

    <span class="hljs-comment"># Optionally define additional schemas here:</span>
    <span class="hljs-attr">schemas:</span>
      <span class="hljs-comment"># When creating an identity that uses this schema, `traits_schema_id: customer` would be set for that identity.</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">customer</span>
        <span class="hljs-attr">url:</span> <span class="hljs-string">http://foo.bar.com/customer.schema.json</span>
</code></pre>
<p>ORY Kratos enforces each of these schemas when at an identity's creation or
update. The employed business logic must be able to distingush between these
three identities. The switch statement is used in this case. For example:</p>
<pre><code class="hljs css language-go"><span class="hljs-comment">// This is an example program that can deal with all three identities</span>
<span class="hljs-comment">// session := ...</span>
<span class="hljs-keyword">switch</span> (session.Identity.TraitsSchemaURL) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"customer"</span>:
        <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"employee"</span>:
        <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"default"</span>:
        <span class="hljs-keyword">fallthrough</span>
    <span class="hljs-keyword">default</span>:
        <span class="hljs-comment">// ...</span>
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="json-schema-vocabulary-extensions"></a><a href="#json-schema-vocabulary-extensions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JSON Schema Vocabulary Extensions</h2>
<p>As already explained, traits tell ORY Kratos that a particular field has a
system-relevant meaning. That would for example include:</p>
<ul>
<li>The email address for recovering a lost password</li>
<li>The identifier for logging in e.g. username and password or email and password</li>
<li>The phone number for enabling SMS 2FA</li>
<li>...</li>
</ul>
<p>ORY Kratos' JSON Schema Vocabulary Extension can be used within a property:</p>
<pre><code class="hljs css language-json5">{
  $id: <span class="hljs-symbol">'http</span>:<span class="hljs-comment">//mydomain.com/schemas/v2/customer.schema.json',</span>
  $schema: <span class="hljs-symbol">'http</span>:<span class="hljs-comment">//json-schema.org/draft-07/schema#',</span>
  title: <span class="hljs-symbol">'A</span> customer (v2)',
  <span class="hljs-class"><span class="hljs-keyword">type</span></span>: <span class="hljs-symbol">'objec</span>t',
  properties: {
    email: {
      title: <span class="hljs-symbol">'E</span>-<span class="hljs-type">Mail</span>',
      <span class="hljs-class"><span class="hljs-keyword">type</span></span>: <span class="hljs-symbol">'strin</span>g',
      format: <span class="hljs-symbol">'emai</span>l',

      <span class="hljs-comment">// This tells ORY Kratos that the field should be used as the "username" for the username+password flow.</span>
      <span class="hljs-comment">// It is an extension to the regular JSON Schema vocabulary.</span>
      <span class="hljs-symbol">'ory</span>.sh/kratos': {
        credentials: {
          password: {
            identifier: <span class="hljs-literal">true</span>,
          },
        },
      },
    },
  },
}
</code></pre>
<p>An overview of available configuration options follows in the next sections.</p>
<h3><a class="anchor" aria-hidden="true" id="identifier-for-username-and-password-flows"></a><a href="#identifier-for-username-and-password-flows" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Identifier for Username and Password Flows</h3>
<p>ORY Kratos can set specific fields to be used as the <em>identifier</em> e.g. username,
email, phone number, etc., in the Username and Password Registration and Login
Flow:</p>
<pre><code class="hljs css language-json5"><span class="hljs-string">{</span>
  <span class="hljs-attr">'ory.sh/kratos':</span> <span class="hljs-string">{</span>
    <span class="hljs-attr">credentials:</span> <span class="hljs-string">{</span>
      <span class="hljs-attr">password:</span> <span class="hljs-string">{</span>
        <span class="hljs-attr">identifier:</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span>
      <span class="hljs-string">},</span>
    <span class="hljs-string">},</span>
  <span class="hljs-string">},</span>
<span class="hljs-string">}</span>
</code></pre>
<p>Looking at the traits from above</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">traits:</span>
  <span class="hljs-comment"># These are just examples</span>
  <span class="hljs-attr">email:</span> <span class="hljs-string">office@ory.sh</span>
  <span class="hljs-attr">name:</span>
    <span class="hljs-attr">first:</span> <span class="hljs-string">Aeneas</span>
    <span class="hljs-attr">last:</span> <span class="hljs-string">Rekkas</span>
  <span class="hljs-attr">favorite_animal:</span> <span class="hljs-string">Dog</span>
  <span class="hljs-attr">accepted_tos:</span> <span class="hljs-literal">true</span>
</code></pre>
<p>and using a JSON Schema that uses the <code>email</code> field as the identifier for the
password flow</p>
<pre><code class="hljs css language-json5">{
  $id: <span class="hljs-symbol">'http</span>:<span class="hljs-comment">//mydomain.com/schemas/v2/customer.schema.json',</span>
  $schema: <span class="hljs-symbol">'http</span>:<span class="hljs-comment">//json-schema.org/draft-07/schema#',</span>
  title: <span class="hljs-symbol">'A</span> customer (v2)',
  <span class="hljs-class"><span class="hljs-keyword">type</span></span>: <span class="hljs-symbol">'objec</span>t',
  properties: {
    email: {
      title: <span class="hljs-symbol">'E</span>-<span class="hljs-type">Mail</span>',
      <span class="hljs-class"><span class="hljs-keyword">type</span></span>: <span class="hljs-symbol">'strin</span>g',
      format: <span class="hljs-symbol">'emai</span>l',

      <span class="hljs-comment">// This tells ORY Kratos that the field should be used as the "username" for the Username and Password Flow.</span>
      <span class="hljs-symbol">'ory</span>.sh/kratos': {
        credentials: {
          password: {
            identifier: <span class="hljs-literal">true</span>,
          },
        },
      },
    },
    name: {
      <span class="hljs-class"><span class="hljs-keyword">type</span></span>: <span class="hljs-symbol">'objec</span>t',
      properties: {
        first: {
          <span class="hljs-class"><span class="hljs-keyword">type</span></span>: <span class="hljs-symbol">'strin</span>g',
        },
        last: {
          <span class="hljs-class"><span class="hljs-keyword">type</span></span>: <span class="hljs-symbol">'strin</span>g',
        },
      },
    },
    favorite_animal: {
      <span class="hljs-class"><span class="hljs-keyword">type</span></span>: <span class="hljs-symbol">'strin</span>g',
    },
    accepted_tos: {
      <span class="hljs-class"><span class="hljs-keyword">type</span></span>: <span class="hljs-symbol">'strin</span>g',
    },
  },
  required: [<span class="hljs-symbol">'emai</span>l'],
  additionalProperties: <span class="hljs-literal">false</span>,
}
</code></pre>
<p>In this example, ORY Kratos understands that traits:email: <code>office@ory.sh</code> is
the identity's identifier. The system expects <code>office@ory.sh</code> plus a password to
sign in.</p>
<p><a href="/docs/kratos/concepts/credentials#username-and-password">Username and Password Credentials</a>
contains more information and examples.</p>
<p>There are currently no other extensions supported for Identity Traits. Further
fields will be added in future releases!</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 1/28/2020 by hackerman</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/kratos/concepts/ui-user-interface"><span class="arrow-prev">← </span><span>User Interface</span></a><a class="docs-next button" href="/docs/kratos/concepts/credentials"><span>Credentials</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#identity-traits-and-json-schemas">Identity Traits and JSON Schemas</a></li><li><a href="#json-schema-vocabulary-extensions">JSON Schema Vocabulary Extensions</a><ul class="toc-headings"><li><a href="#identifier-for-username-and-password-flows">Identifier for Username and Password Flows</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2020 ORY GmbH</section><div id="codefund"></div><script src="https://codefund.io/properties/140/funder.js" async=""></script><script>(function () {
  document.querySelectorAll('.tabs .tabs-nav .nav-item a').forEach(function (t) {
    t.addEventListener("click", function (e) {
      e.preventDefault();

      t.closest('.tabs-nav').querySelectorAll('.nav-item a').forEach(function (i) {
        i.classList.remove('active');
      });

      t.closest('.tabs').querySelectorAll('.tab-content .tab-pane').forEach(function (i) {
        i.classList.remove('active');
      });

      t.classList.add('active');
      document.getElementById(t.href.split('#')[1]).classList.add('active');
      return false
    });
  });
})();</script></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '8463c6ece843b377565726bb4ed325b0',
                indexName: 'ory',
                inputSelector: '#search_input_react'
              });
            </script></body></html>