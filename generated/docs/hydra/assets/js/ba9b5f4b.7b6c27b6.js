(window.webpackJsonp=window.webpackJsonp||[]).push([[358],{430:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return i})),t.d(n,"metadata",(function(){return s})),t.d(n,"toc",(function(){return l})),t.d(n,"default",(function(){return p}));var a=t(3),r=t(8),o=(t(0),t(568)),i={id:"hydra-janitor",title:"hydra janitor",description:"hydra janitor Clean the database of old tokens and login/consent requests"},s={unversionedId:"cli/hydra-janitor",id:"version-v1.10/cli/hydra-janitor",isDocsHomePage:!1,title:"hydra janitor",description:"hydra janitor Clean the database of old tokens and login/consent requests",source:"@site/versioned_docs/version-v1.10/cli/hydra-janitor.md",slug:"/cli/hydra-janitor",permalink:"/hydra/docs/cli/hydra-janitor",editUrl:"https://github.com/ory/hydra/edit/master/docs/versioned_docs/version-v1.10/cli/hydra-janitor.md",version:"v1.10",sidebar:"version-v1.10/docs",previous:{title:"hydra clients update",permalink:"/hydra/docs/cli/hydra-clients-update"},next:{title:"hydra keys",permalink:"/hydra/docs/cli/hydra-keys"}},l=[{value:"hydra janitor",id:"hydra-janitor",children:[{value:"Synopsis",id:"synopsis",children:[]},{value:"Warning",id:"warning",children:[]},{value:"Options",id:"options",children:[]},{value:"SEE ALSO",id:"see-also",children:[]}]}],c={toc:l};function p(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},c,t,{components:n,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"hydra-janitor"},"hydra janitor"),Object(o.b)("p",null,"Clean the database of old tokens and login/consent requests"),Object(o.b)("h3",{id:"synopsis"},"Synopsis"),Object(o.b)("p",null,"This command will cleanup any expired oauth2 tokens as well as login/consent\nrequests."),Object(o.b)("h3",{id:"warning"},"Warning"),Object(o.b)("p",null,"This command is in beta. Proceed with caution!"),Object(o.b)("p",null,"This is a destructive command and will purge data directly from the database.\nPlease use this command with caution if you need to keep historic data for any\nreason."),Object(o.b)("p",null,"###############"),Object(o.b)("p",null,"Janitor can be used in several ways."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"By passing the database connection string (DSN) as an argument Pass the\ndatabase url (dsn) as an argument to janitor. E.g. janitor\n","<","database-url",">")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"By passing the DSN as an environment variable"),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre"},"export DSN=...\njanitor -e\n"))),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"By passing a configuration file containing the DSN janitor -c\n/path/to/conf.yml")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Extra ",Object(o.b)("em",{parentName:"p"},"optional")," parameters can also be added such as"),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre"},"janitor --keep-if-younger 23h --access-lifespan 1h --refresh-lifespan 40h --consent-request-lifespan 10m &lt;database-url&gt;\n"))),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Running only a certain cleanup"),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre"},"janitor --tokens &lt;database-url&gt;\n")),Object(o.b)("p",{parentName:"li"},"or"),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre"},"janitor --requests &lt;database-url&gt;\n")),Object(o.b)("p",{parentName:"li"},"or both"),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre"},"janitor --tokens --requests &lt;database-url&gt;\n")))),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"hydra janitor [&lt;database-url&gt;] [flags]\n")),Object(o.b)("h3",{id:"options"},"Options"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"      --access-lifespan duration            Set the access token lifespan e.g. 1s, 1m, 1h.\n  -c, --config strings                      Path to one or more .json, .yaml, .yml, .toml config files. Values are loaded in the order provided, meaning that the last config file overwrites values from the previous config file.\n      --consent-request-lifespan duration   Set the login/consent request lifespan e.g. 1s, 1m, 1h\n  -h, --help                                help for janitor\n      --keep-if-younger duration            Keep database records that are younger than a specified duration e.g. 1s, 1m, 1h.\n  -e, --read-from-env                       If set, reads the database connection string from the environment variable DSN or config file key dsn.\n      --refresh-lifespan duration           Set the refresh token lifespan e.g. 1s, 1m, 1h.\n      --requests                            This will only run the cleanup on requests and will skip token cleanup.\n      --tokens                              This will only run the cleanup on tokens and will skip requests cleanup.\n")),Object(o.b)("h3",{id:"see-also"},"SEE ALSO"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",{parentName:"li",href:"hydra"},"hydra")," - Run and manage ORY Hydra")))}p.isMDXComponent=!0},568:function(e,n,t){"use strict";t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return h}));var a=t(0),r=t.n(a);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=r.a.createContext({}),p=function(e){var n=r.a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=p(e.components);return r.a.createElement(c.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},u=r.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(t),u=a,h=d["".concat(i,".").concat(u)]||d[u]||b[u]||o;return t?r.a.createElement(h,s(s({ref:n},c),{},{components:t})):r.a.createElement(h,s({ref:n},c))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=t[c];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,t)}u.displayName="MDXCreateElement"}}]);