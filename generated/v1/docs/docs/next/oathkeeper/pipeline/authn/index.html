<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Authenticators · ORY Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&gt; !!WARNING!!  "/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Authenticators · ORY Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.ory.sh/"/><meta property="og:description" content="&gt; !!WARNING!!  "/><meta property="og:image" content="https://www.ory.sh/images/logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://www.ory.sh/images/logo.png"/><link rel="shortcut icon" href="/images/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-71865250-1', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/images/logo.svg" alt="ORY Documentation"/></a><a href="/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/" target="_self">Home</a></li><li class=""><a href="/blog" target="_self">Blog</a></li><li class=""><a href="https://community.ory.sh" target="_self">Forum</a></li><li class=""><a href="/chat" target="_self">Chat</a></li><li class="siteNavGroupActive"><a href="/docs/next/" target="_self">Docs</a></li><li class=""><a href="https://github.com/ory/" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Pipeline Handlers</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Welcome<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/">ORY Developer Documentation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Ecosystem<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/projects">Projects</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/software-architecture-philosophy">Software Architecture and Philosophy</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/deployment">Deployment Fundamentals and Requirements</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/configuring">Configuring ORY services</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/versioning">Software Versions and Project Maturity</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/upgrading">Software Updates</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/api-design">API Design</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/community">Community</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/roadmap">Roadmap</a></li><li class="navListItem"><a class="navItem" href="/docs/next/ecosystem/sqa">Software Quality Assurance</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Kratos<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Introduction</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/quickstart">Quickstart</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/install">Installation</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/ui-user-interface">User Interface</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/identity-user-model">Identity and User Model</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/credentials">Credentials</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/email-sms">Out-of-band communication via E-Mail and SMS</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/federation">Federation</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/concepts/security">Threat Models and Security Profiles</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Self Service Flows</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/user-login-user-registration">User Login and User Registration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/user-logout">User Logout</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/user-profile-management">Profile Management</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/password-reset-account-recovery">Account Recovery</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/user-facing-errors">User-Facing Errors</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/flows/verify-email-account-activation">Email and Phone Verification and Account Activation</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Self Service Strategies</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/strategies/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/strategies/username-email-password">Username or Email and Password</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/strategies/openid-connect-social-sign-in-oauth2">Social Sign In with OpenID Connect and OAuth2</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Self Service Jobs and Workflows</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/workflows/jobs/before">Before Jobs</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/self-service/workflows/jobs/after">After Jobs</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Reference</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/reference/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/reference/json-schema-json-paths">JSON Schema and JSON Paths</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/reference/html-forms">HTML Form Parser</a></li><li class="navListItem"><a class="navItem" href="/docs/next/kratos/sdk/api">REST API</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/sdk/">Overview</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Further Reading</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/kratos/further-reading/comparison">Comparison</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Hydra<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/hydra/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/install">Installation</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/oauth2">OAuth 2.0</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/login-consent-flow">Hydra workflow</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Integrating Hydra into your stack</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/5min-tutorial">5 Minute Tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/implementing-consent">Login, Consent &amp; Logout</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/case-study">OAuth 2.0 Case Study</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/configure-deploy">Installation and Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/dependencies-environment">Database Setup and Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/production">Preparing for Production</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/debugging">Debugging</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/advanced">Advanced Topics</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/integration">Consuming OAuth 2.0</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API &amp; SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/api">REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/go">Go</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/js">JavaScript</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/sdk/php">PHP</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Further Reading</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/hydra/limitations">Limitations</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/jwks">JSON Web Key Sets</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/security-architecture">Security Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/next/hydra/faq">FAQ</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Oathkeeper<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/install">Installation</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Core Concepts</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/api-access-rules">API Access Rules</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Pipeline Handlers</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/pipeline/">Access Rule Pipeline</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/next/oathkeeper/pipeline/authn">Authenticators</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/pipeline/authz">Authorizers</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/pipeline/mutator">Mutators</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/pipeline/error">Error Handlers</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/configure-deploy">Configure and Deploy</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API &amp; SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/sdk/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/oathkeeper/sdk/api">REST API</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">ORY Keto<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/keto/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/install">Installation</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/keto/configure-deploy">Configure and Deploy</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/configuration">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/secure">Secure</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Control Engines</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/">Access Control Engines - Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/acl">Access Control Lists (ACL)</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/rbac">Role Based Access Control (RBAC)</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/acp-ory">ORY Access Control Policies</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/engines/acp-aws">AWS IAM Policies</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API &amp; SDKs</h4><ul><li class="navListItem"><a class="navItem" href="/docs/next/keto/sdk/">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/keto/sdk/api">REST API</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Performance<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/performance/">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/next/performance/hydra">ORY Hydra</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/ory/docs/edit/master/docs/oathkeeper/pipeline/authn.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Authenticators</h1></header><article><div><span><blockquote>
<p>!!WARNING!!</p>
<p>This document is outdated. Please go to <a href="https://www.ory.sh/docs">www.ory.sh/docs</a> for a recent version!
An authenticator is responsible for authenticating request credentials. ORY
Oathkeeper supports different authenticators and we will add more as the project
progresses.</p>
</blockquote>
<p>An authenticator inspects the HTTP request (e.g. the HTTP Authorization Header)
and executes some business logic that returns true (for authentication ok) or
false (for authentication invalid) as well as a subject (&quot;user&quot;). The subject is
typically the &quot;user&quot; that made the request, but it could also be a machine (if
you have machine-2-machine interaction) or something different.</p>
<p>Each authenticator has two keys:</p>
<ul>
<li><code>handler</code> (string, required): Defines the handler (e.g. <code>noop</code>) to be used.</li>
<li><code>config</code> (object, optional): Configures the handler. Configuration keys vary
per handler. The configuration can be defined in the global configuration
file, or per access rule.</li>
</ul>
<p><strong>Example</strong></p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"authenticators"</span>: [
    {
      <span class="hljs-attr">"handler"</span>: <span class="hljs-string">"noop"</span>,
      <span class="hljs-attr">"config"</span>: {}
    }
  ]
}
</code></pre>
<p>You can define more than one authenticator in the Access Rule. The first
authenticator that is able to handle the credentials will be consulted and other
authenticators will be ignored:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"authenticators"</span>: [
    {
      <span class="hljs-attr">"handler"</span>: <span class="hljs-string">"a"</span>
    },
    {
      <span class="hljs-attr">"handler"</span>: <span class="hljs-string">"b"</span>
    },
    {
      <span class="hljs-attr">"handler"</span>: <span class="hljs-string">"c"</span>
    }
  ]
}
</code></pre>
<p>If handler <code>a</code> is able to handle the provided credentials, then handler <code>b</code> and
<code>c</code> will be ignored. If handler <code>a</code> can not handle the provided credentials but
handler <code>b</code> can, then handler <code>a</code> and <code>c</code> will be ignored. Handling the provided
credentials means that the authenticator knows how to handle, for example, the
<code>Authorization: basic</code> header. It does not mean that the credentials are valid!
If a handler encounters invalid credentials, then other handlers will be ignored
too.</p>
<h2><a class="anchor" aria-hidden="true" id="noop"></a><a href="#noop" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>noop</code></h2>
<p>The <code>noop</code> handler tells ORY Oathkeeper to bypass authentication, authorization,
and mutation. This implies that no authorization will be executed and no
credentials will be issued. It's basically a pass-all authenticator that allows
any request to be forwarded to the upstream URL.</p>
<blockquote>
<p>Using this handler is basically an allow-all configuration. It makes sense
when the upstream handles access control itself or does not need any type of
access control.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="configuration"></a><a href="#configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h3>
<p>This handler is not configurable.</p>
<p>To enable this handler, set:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Global configuration file oathkeeper.yml</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-attr">noop:</span>
    <span class="hljs-comment"># Set enabled to true if the authenticator should be enabled and false to disable the authenticator. Defaults to false.</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="access-rule-example"></a><a href="#access-rule-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Access Rule Example</h3>
<pre><code class="hljs css language-sh">$ cat ./rules.json

[{
  <span class="hljs-string">"id"</span>: <span class="hljs-string">"some-id"</span>,
  <span class="hljs-string">"upstream"</span>: {
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"http://my-backend-service"</span>
  },
  <span class="hljs-string">"match"</span>: {
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"http://my-app/some-route"</span>,
    <span class="hljs-string">"methods"</span>: [
      <span class="hljs-string">"GET"</span>
    ]
  },
  <span class="hljs-string">"authenticators"</span>: [{
    <span class="hljs-string">"handler"</span>: <span class="hljs-string">"noop"</span>
  }]
}]

$ curl -X GET http://my-app/some-route

HTTP/1.0 200 Status OK
The request has been allowed!
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="unauthorized"></a><a href="#unauthorized" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>unauthorized</code></h2>
<p>The <code>unauthorized</code> handler tells ORY Oathkeeper to reject all requests as
unauthorized.</p>
<h3><a class="anchor" aria-hidden="true" id="configuration-1"></a><a href="#configuration-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h3>
<p>This handler is not configurable.</p>
<p>To enable this handler, set:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Global configuration file oathkeeper.yml</span>
<span class="hljs-attr">unauthorized:</span>
  <span class="hljs-attr">noop:</span>
    <span class="hljs-comment"># Set enabled to true if the authenticator should be enabled and false to disable the authenticator. Defaults to false.</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="access-rule-example-1"></a><a href="#access-rule-example-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Access Rule Example</h3>
<pre><code class="hljs css language-sh">$ cat ./rules.json

[{
  <span class="hljs-string">"id"</span>: <span class="hljs-string">"some-id"</span>,
  <span class="hljs-string">"upstream"</span>: {
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"http://my-backend-service"</span>
  },
  <span class="hljs-string">"match"</span>: {
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"http://my-app/some-route"</span>,
    <span class="hljs-string">"methods"</span>: [
      <span class="hljs-string">"GET"</span>
    ]
  },
  <span class="hljs-string">"authenticators"</span>: [{
    <span class="hljs-string">"handler"</span>: <span class="hljs-string">"unauthorized"</span>
  }]
}]

$ curl -X GET http://my-app/some-route

HTTP/1.0 401 Unauthorized
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="anonymous"></a><a href="#anonymous" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>anonymous</code></h2>
<p>The <code>anonymous</code> authenticator checks whether or not an <code>Authorization</code> header is
set. If not, it will set the subject to <code>anonymous</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="configuration-2"></a><a href="#configuration-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h3>
<ul>
<li><code>subject</code> (string, optional) - Sets the anonymous username. Defaults to
&quot;anonymous&quot;. Common names include &quot;guest&quot;, &quot;anon&quot;, &quot;anonymous&quot;, &quot;unknown&quot;.</li>
</ul>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Global configuration file oathkeeper.yml</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-attr">anonymous:</span>
    <span class="hljs-comment"># Set enabled to true if the authenticator should be enabled and false to disable the authenticator. Defaults to false.</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>

    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">subject:</span> <span class="hljs-string">guest</span>
</code></pre>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Some Access Rule: access-rule-1.yaml</span>
<span class="hljs-attr">id:</span> <span class="hljs-string">access-rule-1</span>
<span class="hljs-comment"># match: ...</span>
<span class="hljs-comment"># upstream: ...</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">handler:</span> <span class="hljs-string">anonymous</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">subject:</span> <span class="hljs-string">guest</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="access-rule-example-2"></a><a href="#access-rule-example-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Access Rule Example</h3>
<p>The following rule allows all requests to <code>GET http://my-app/some-route</code> and
sets the subject name to the anonymous username, as long as no <code>Authorization</code>
header is set in the HTTP request:</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> cat ./rules.json</span>

[{
  "id": "some-id",
  "upstream": {
    "url": "http://my-backend-service"
  },
  "match": {
    "url": "http://my-app/some-route",
    "methods": [
      "GET"
    ]
  },
  "authenticators": [{
    "handler": "anonymous"
  }],
  "authorizer": { "handler": "allow" },
  "mutators": [{ "handler": "noop" }]
}]
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET http://my-app/some-route</span>

HTTP/1.0 200 Status OK
The request has been allowed! The subject is: "anonymous"
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET -H <span class="hljs-string">"Authorization: Bearer foobar"</span> http://my-app/some-route</span>

HTTP/1.0 401 Status Unauthorized
The request is not authorized because credentials have been provided but only the anonymous
authenticator is enabled for this URL.
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="cookie_session"></a><a href="#cookie_session" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>cookie_session</code></h2>
<p>The <code>cookie_session</code> authenticator will forward the request method, path and
headers to a session store. If the session store returns <code>200 OK</code> and body
<code>{ &quot;subject&quot;: &quot;...&quot;, &quot;extra&quot;: {} }</code> then the authenticator will set the subject
appropriately.</p>
<h3><a class="anchor" aria-hidden="true" id="configuration-3"></a><a href="#configuration-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h3>
<ul>
<li><code>check_session_url</code> (string, required) - The session store to forward request
method/path/headers to for validation.</li>
<li><code>only</code> ([]string, optional) - If set, only requests that have at least one of
the set cookies will be forwarded, others will be passed to the next
authenticator. If unset, all requests are forwarded.</li>
<li><code>preserve_path</code> (boolean, optional) - If set, any path in <code>check_session_url</code>
will be preserved instead of replacing the path with the path of the request
being checked.</li>
<li><code>extra_from</code> (string, optional - defaults to <code>extra</code>) - A
<a href="https://github.com/tidwall/gjson/blob/master/SYNTAX.md">GJSON Path</a> pointing
to the <code>extra</code> field. This defaults to <code>extra</code>, but it could also be <code>@this</code>
(for the root element), <code>session.foo.bar</code> for
<code>{ &quot;subject&quot;: &quot;...&quot;, &quot;session&quot;: { &quot;foo&quot;: {&quot;bar&quot;: &quot;whatever&quot;} } }</code>, and so on.</li>
<li><code>subject_from</code> (string, optional - defaults to <code>subject</code>) - A
<a href="https://github.com/tidwall/gjson/blob/master/SYNTAX.md">GJSON Path</a> pointing
to the <code>subject</code> field. This defaults to <code>subject</code>. Example: <code>identity.id</code> for
<code>{ &quot;identity&quot;: { &quot;id&quot;: &quot;1234&quot; } }</code>.</li>
</ul>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Global configuration file oathkeeper.yml</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-attr">cookie_session:</span>
    <span class="hljs-comment"># Set enabled to true if the authenticator should be enabled and false to disable the authenticator. Defaults to false.</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>

    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">check_session_url:</span> <span class="hljs-string">https://session-store-host</span>
</code></pre>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Some Access Rule: access-rule-1.yaml</span>
<span class="hljs-attr">id:</span> <span class="hljs-string">access-rule-1</span>
<span class="hljs-comment"># match: ...</span>
<span class="hljs-comment"># upstream: ...</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">handler:</span> <span class="hljs-string">cookie_session</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">check_session_url:</span> <span class="hljs-string">https://session-store-host</span>
      <span class="hljs-attr">only:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">sessionid</span>
</code></pre>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Some Access Rule Preserving Path: access-rule-2.yaml</span>
<span class="hljs-attr">id:</span> <span class="hljs-string">access-rule-2</span>
<span class="hljs-comment"># match: ...</span>
<span class="hljs-comment"># upstream: ...</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">handler:</span> <span class="hljs-string">cookie_session</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">check_session_url:</span> <span class="hljs-string">https://session-store-host/check-session</span>
      <span class="hljs-attr">only:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">sessionid</span>
      <span class="hljs-attr">preserve_path:</span> <span class="hljs-literal">true</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="access-rule-example-3"></a><a href="#access-rule-example-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Access Rule Example</h3>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> cat ./rules.json</span>

[{
  "id": "some-id",
  "upstream": {
    "url": "http://my-backend-service"
  },
  "match": {
    "url": "http://my-app/some-route",
    "methods": [
      "GET"
    ]
  },
  "authenticators": [{
    "handler": "cookie_session"
  }],
  "authorizer": { "handler": "allow" },
  "mutators": [{ "handler": "noop" }]
}]
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET -b sessionid=abc http://my-app/some-route</span>

HTTP/1.0 200 OK
The request has been allowed! The subject is: "peter"
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET -b sessionid=def http://my-app/some-route</span>

HTTP/1.0 401 Status Unauthorized
The request is not authorized because the provided credentials are invalid.
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="oauth2_client_credentials"></a><a href="#oauth2_client_credentials" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>oauth2_client_credentials</code></h2>
<p>This <code>oauth2_client_credentials</code> uses the username and password from HTTP Basic
Authorization (<code>Authorization: Basic base64(&lt;username:password&gt;)</code> to perform the
OAuth 2.0 Client Credentials grant in order to detect if the provided
credentials are valid.</p>
<p>This authenticator will use the username from the HTTP Basic Authorization
header as the subject for this request.</p>
<blockquote>
<p>If you are unfamiliar with OAuth 2.0 Introspection we recommend
<a href="https://www.oauth.com/oauth2-servers/access-tokens/client-credentials/">reading this guide</a>.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="configuration-4"></a><a href="#configuration-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h3>
<ul>
<li><code>token_url</code> (string, required) - The OAuth 2.0 Token Endpoint that will be
used to validate the client credentials.</li>
<li><code>required_scope</code> ([]string, optional) - Sets what scope is required by the URL
and when making performing OAuth 2.0 Client Credentials request, the scope
will be included in the request:</li>
</ul>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Global configuration file oathkeeper.yml</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-attr">oauth2_client_credentials:</span>
    <span class="hljs-comment"># Set enabled to true if the authenticator should be enabled and false to disable the authenticator. Defaults to false.</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>

    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">token_url:</span> <span class="hljs-string">https://my-website.com/oauth2/token</span>
</code></pre>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Some Access Rule: access-rule-1.yaml</span>
<span class="hljs-attr">id:</span> <span class="hljs-string">access-rule-1</span>
<span class="hljs-comment"># match: ...</span>
<span class="hljs-comment"># upstream: ...</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">handler:</span> <span class="hljs-string">oauth2_client_credentials</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">token_url:</span> <span class="hljs-string">https://my-website.com/oauth2/token</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="access-rule-example-4"></a><a href="#access-rule-example-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Access Rule Example</h3>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> cat ./rules.json</span>

[{
  "id": "some-id",
  "upstream": {
    "url": "http://my-backend-service"
  },
  "match": {
    "url": "http://my-app/some-route",
    "methods": [
      "GET"
    ]
  },
  "authenticators": [{
    "handler": "oauth2_client_credentials",
    "config": {
      "required_scope": ["scope-a", "scope-b"]
    }
  }],
  "authorizer": { "handler": "allow" },
  "mutators": [{ "handler": "noop" }]
}]
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET http://my-app/some-route</span>

HTTP/1.0 401 Status Unauthorized
The request is not authorized because no credentials have been provided.
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET --user idonotexist:whatever http://my-app/some-route</span>

HTTP/1.0 401 Status Unauthorized
The request is not authorized because the provided credentials are invalid.
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET --user peter:somesecret http://my-app/some-route</span>

HTTP/1.0 200 OK
The request has been allowed! The subject is: "peter"
</code></pre>
<p>In the background, a request to the OAuth 2.0 Token Endpoint (value of
<code>authenticators.oauth2_client_credentials.token_url</code>) will be made, using the
OAuth 2.0 Client Credentials Grant:</p>
<pre><code class="hljs"><span class="hljs-keyword">POST</span> <span class="hljs-string">/oauth2/token</span> HTTP/1.1
<span class="hljs-attribute">Host</span>: authorization-server.com

<span class="routeros"><span class="hljs-attribute">grant_type</span>=client_credentials
&amp;<span class="hljs-attribute">client_id</span>=peter
&amp;<span class="hljs-attribute">client_secret</span>=somesecret
&amp;<span class="hljs-attribute">scope</span>=scope-a+scope-b
</span></code></pre>
<p>If the request succeeds, the credentials are considered valid and if the request
fails, the credentials are considered invalid.</p>
<h2><a class="anchor" aria-hidden="true" id="oauth2_introspection"></a><a href="#oauth2_introspection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>oauth2_introspection</code></h2>
<p>The <code>oauth2_introspection</code> authenticator handles requests that have an Bearer
Token in the Authorization Header (<code>Authorization: bearer &lt;token&gt;</code>) or in a
different header or query parameter specified in configuration. It then uses
OAuth 2.0 Token Introspection to check if the token is valid and if the token
was granted the requested scope.</p>
<blockquote>
<p>If you are unfamiliar with OAuth 2.0 Introspection we recommend
<a href="https://www.oauth.com/oauth2-servers/token-introspection-endpoint/">reading this guide</a>.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="configuration-5"></a><a href="#configuration-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h3>
<ul>
<li><code>introspection_url</code> (string, required) - The OAuth 2.0 Token Introspection
endpoint.</li>
<li><code>scope_strategy</code> (string, optional) - Sets the strategy to be used to
validate/match the token scope. Supports &quot;hierarchic&quot;, &quot;exact&quot;, &quot;wildcard&quot;,
&quot;none&quot;. Defaults to &quot;none&quot;.</li>
<li><code>required_scope</code> ([]string, optional) - Sets what scope is required by the URL
and when making performing OAuth 2.0 Client Credentials request, the scope
will be included in the request</li>
<li><code>pre_authorization</code> (object, optional) - Enable pre-authorization in cases
where the OAuth 2.0 Token Introspection endpoint is protected by OAuth 2.0
Bearer Tokens that can be retrieved using the OAuth 2.0 Client Credentials
grant.
<ul>
<li><code>enabled</code> (bool, optional) - Enable pre-authorization. Defaults to false.</li>
<li><code>client_id</code> (string, required if enabled) - The OAuth 2.0 Client ID to be
used for the OAuth 2.0 Client Credentials Grant.</li>
<li><code>client_secret</code> (string, required if enabled) - The OAuth 2.0 Client Secret
to be used for the OAuth 2.0 Client Credentials Grant.</li>
<li><code>token_url</code> (string, required if enabled) - The OAuth 2.0 Scope to be
requested during the OAuth 2.0 Client Credentials Grant.</li>
<li><code>scope</code> ([]string, optional) - The OAuth 2.0 Token Endpoint where the OAuth
2.0 Client Credentials Grant will be performed.</li>
</ul></li>
<li><code>token_from</code> (object, optional) - The location of the bearer token. If not
configured, the token will be received from a default location -
'Authorization' header. One and only one location (header, query, or cookie)
must be specified.
<ul>
<li><code>header</code> (string, required, one of) - The header (case insensitive) that
must contain a Bearer token for request authentication. It can't be set
along with <code>query_parameter</code> or <code>cookie</code>.</li>
<li><code>query_parameter</code> (string, required, one of) - The query parameter (case
sensitive) that must contain a Bearer token for request authentication. It
can't be set along with <code>header</code> or <code>cookie</code>.</li>
<li><code>cookie</code> (string, required, one of) - The cookie (case sensitive) that must
contain a Bearer token for request authentication. It can't be set along
with <code>header</code> or <code>query_parameter</code></li>
</ul></li>
<li><code>introspection_request_headers</code> (object, optional) - Additional headers to add
to the introspection request</li>
</ul>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Global configuration file oathkeeper.yml</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-attr">oauth2_introspection:</span>
    <span class="hljs-comment"># Set enabled to true if the authenticator should be enabled and false to disable the authenticator. Defaults to false.</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>

    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">introspection_url:</span> <span class="hljs-string">https://my-website.com/oauth2/introspection</span>
      <span class="hljs-attr">scope_strategy:</span> <span class="hljs-string">exact</span>
      <span class="hljs-attr">required_scope:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">photo</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">profile</span>
      <span class="hljs-attr">pre_authorization:</span>
        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
        <span class="hljs-attr">client_id:</span> <span class="hljs-string">some_id</span>
        <span class="hljs-attr">client_secret:</span> <span class="hljs-string">some_secret</span>
        <span class="hljs-attr">scope:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-string">introspect</span>
        <span class="hljs-attr">token_url:</span> <span class="hljs-string">https://my-website.com/oauth2/token</span>
      <span class="hljs-attr">token_from:</span>
        <span class="hljs-attr">header:</span> <span class="hljs-string">Custom-Authorization-Header</span>
        <span class="hljs-comment"># or</span>
        <span class="hljs-comment"># query_parameter: auth-token</span>
        <span class="hljs-comment"># or</span>
        <span class="hljs-comment"># cookie: auth-token</span>
      <span class="hljs-attr">introspection_request_headers:</span>
        <span class="hljs-attr">x-forwarded-proto:</span> <span class="hljs-string">https</span>
</code></pre>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Some Access Rule: access-rule-1.yaml</span>
<span class="hljs-attr">id:</span> <span class="hljs-string">access-rule-1</span>
<span class="hljs-comment"># match: ...</span>
<span class="hljs-comment"># upstream: ...</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">handler:</span> <span class="hljs-string">oauth2_introspection</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">introspection_url:</span> <span class="hljs-string">https://my-website.com/oauth2/introspection</span>
      <span class="hljs-attr">scope_strategy:</span> <span class="hljs-string">exact</span>
      <span class="hljs-attr">required_scope:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">photo</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">profile</span>
      <span class="hljs-attr">pre_authorization:</span>
        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
        <span class="hljs-attr">client_id:</span> <span class="hljs-string">some_id</span>
        <span class="hljs-attr">client_secret:</span> <span class="hljs-string">some_secret</span>
        <span class="hljs-attr">scope:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-string">introspect</span>
        <span class="hljs-attr">token_url:</span> <span class="hljs-string">https://my-website.com/oauth2/token</span>
      <span class="hljs-attr">token_from:</span>
        <span class="hljs-attr">query_parameter:</span> <span class="hljs-string">auth-token</span>
        <span class="hljs-comment"># or</span>
        <span class="hljs-comment"># header: Custom-Authorization-Header</span>
        <span class="hljs-comment"># or</span>
        <span class="hljs-comment"># cookie: auth-token</span>
      <span class="hljs-attr">introspection_request_headers:</span>
        <span class="hljs-attr">x-forwarded-proto:</span> <span class="hljs-string">https</span>
        <span class="hljs-attr">x-foo:</span> <span class="hljs-string">bar</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="access-rule-example-5"></a><a href="#access-rule-example-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Access Rule Example</h3>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> cat ./rules.json</span>

[{
  "id": "some-id",
  "upstream": {
    "url": "http://my-backend-service"
  },
  "match": {
    "url": "http://my-app/some-route",
    "methods": [
      "GET"
    ]
  },
  "authenticators": [{
    "handler": "oauth2_introspection",
    "config": {
      "required_scope": ["scope-a", "scope-b"]
    }
  }],
  "authorizer": { "handler": "allow" },
  "mutators": [{ "handler": "noop" }]
}]
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET http://my-app/some-route</span>

HTTP/1.0 401 Status Unauthorized
The request is not authorized because no credentials have been provided.
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET -H <span class="hljs-string">'Authorization: Bearer invalid-token'</span> http://my-app/some-route</span>

HTTP/1.0 401 Status Unauthorized
The request is not authorized because the provided credentials are invalid.
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET -H <span class="hljs-string">'Authorization: Bearer valid.access.token.from.peter'</span> http://my-app/some-route</span>

HTTP/1.0 200 OK
The request has been allowed! The subject is: "peter"
</code></pre>
<p>In the background, this handler will make a request to the OAuth 2.0 Token
Endpoint (configuration value
<code>authenticators.oauth2_introspection.introspection_url</code>) to check if the Bearer
Token is valid:</p>
<pre><code class="hljs"><span class="hljs-keyword">POST</span> <span class="hljs-string">/oauth2/introspect</span> HTTP/1.1

<span class="stylus">token=valid<span class="hljs-selector-class">.access</span><span class="hljs-selector-class">.token</span><span class="hljs-selector-class">.from</span><span class="hljs-selector-class">.peter</span>
</span></code></pre>
<p>If pre-authorization is enabled, that request will include an Authorization
Header:</p>
<pre><code class="hljs"><span class="hljs-keyword">POST</span> <span class="hljs-string">/oauth2/introspect</span> HTTP/1.1
<span class="hljs-attribute">Authorization</span>: Bearer token-received-by-performing-pre-authorization

<span class="stylus">token=valid<span class="hljs-selector-class">.access</span><span class="hljs-selector-class">.token</span><span class="hljs-selector-class">.from</span><span class="hljs-selector-class">.peter</span>
</span></code></pre>
<p>The Token is considered valid if the Introspection response is HTTP 200 OK and
includes <code>{&quot;active&quot;:true}</code> in the response payload. The subject is extracted
from the <code>username</code> field.</p>
<h2><a class="anchor" aria-hidden="true" id="jwt"></a><a href="#jwt" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>jwt</code></h2>
<p>The <code>jwt</code> authenticator handles requests that have an Bearer Token in the
Authorization Header (<code>Authorization: bearer &lt;token&gt;</code>) or in a different header
or query parameter specified in configuration. It assumes that the token is a
JSON Web Token and tries to verify the signature of it.</p>
<h3><a class="anchor" aria-hidden="true" id="configuration-6"></a><a href="#configuration-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h3>
<ul>
<li><code>jwks_urls</code> ([]string, required) - The URLs where ORY Oathkeeper can retrieve
JSON Web Keys from for validating the JSON Web Token. Usually something like
<code>https://my-keys.com/.well-known/jwks.json</code>. The response of that endpoint
must return a JSON Web Key Set (JWKS).</li>
<li><code>scope_strategy</code> (string, optional) - Sets the strategy to be used to
validate/match the scope. Supports &quot;hierarchic&quot;, &quot;exact&quot;, &quot;wildcard&quot;, &quot;none&quot;.
Defaults to &quot;none&quot;.</li>
<li>If <code>trusted_issuers</code> ([]string) is set, the JWT must contain a value for claim
<code>iss</code> that matches <em>exactly</em> (case-sensitive) one of the values of
<code>trusted_issuers</code>. If no values are configured, the issuer will be ignored.</li>
<li>If <code>target_audience</code> ([]string) is set, the JWT must contain all values
(exact, case-sensitive) in the claim <code>aud</code>. If no values are configured, the
audience will be ignored.</li>
<li>Value <code>allowed_algorithms</code> ([]string) sets what signing algorithms are
allowed. Defaults to <code>RS256</code>.</li>
<li>Value <code>required_scope</code> ([]string) validates the scope of the JWT. It will
checks for claims <code>scp</code>, <code>scope</code>, <code>scopes</code> in the JWT when validating the
scope as that claim is not standardized.</li>
<li><code>token_from</code> (object, optional) - The location of the bearer token. If not
configured, the token will be received from a default location -
'Authorization' header. One and only one location (header, query, or cookie)
must be specified.
<ul>
<li><code>header</code> (string, required, one of) - The header (case insensitive) that
must contain a Bearer token for request authentication. It can't be set
along with <code>query_parameter</code> or <code>cookie</code>.</li>
<li><code>query_parameter</code> (string, required, one of) - The query parameter (case
sensitive) that must contain a Bearer token for request authentication. It
can't be set along with <code>header</code> or <code>cookie</code>.</li>
<li><code>cookie</code> (string, required, one of) - The cookie (case sensitive) that must
contain a Bearer token for request authentication. It can't be set along
with <code>header</code> or <code>query_parameter</code></li>
</ul></li>
</ul>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Global configuration file oathkeeper.yml</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-attr">jwt:</span>
    <span class="hljs-comment"># Set enabled to true if the authenticator should be enabled and false to disable the authenticator. Defaults to false.</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>

    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">jwks_urls:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-website.com/.well-known/jwks.json</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-other-website.com/.well-known/jwks.json</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">file://path/to/local/jwks.json</span>
      <span class="hljs-attr">scope_strategy:</span> <span class="hljs-string">none</span>
      <span class="hljs-attr">required_scope:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">scope-a</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">scope-b</span>
      <span class="hljs-attr">target_audience:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-service.com/api/users</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-service.com/api/devices</span>
      <span class="hljs-attr">trusted_issuers:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-issuer.com/</span>
      <span class="hljs-attr">allowed_algorithms:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">RS256</span>
      <span class="hljs-attr">token_from:</span>
        <span class="hljs-attr">header:</span> <span class="hljs-string">Custom-Authorization-Header</span>
        <span class="hljs-comment"># or</span>
        <span class="hljs-comment"># query_parameter: auth-token</span>
        <span class="hljs-comment"># or</span>
        <span class="hljs-comment"># cookie: auth-token</span>
</code></pre>
<pre><code class="hljs css language-yaml"><span class="hljs-comment"># Some Access Rule: access-rule-1.yaml</span>
<span class="hljs-attr">id:</span> <span class="hljs-string">access-rule-1</span>
<span class="hljs-comment"># match: ...</span>
<span class="hljs-comment"># upstream: ...</span>
<span class="hljs-attr">authenticators:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">handler:</span> <span class="hljs-string">jwt</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">jwks_urls:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-website.com/.well-known/jwks.json</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-other-website.com/.well-known/jwks.json</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">file://path/to/local/jwks.json</span>
      <span class="hljs-attr">scope_strategy:</span> <span class="hljs-string">none</span>
      <span class="hljs-attr">required_scope:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">scope-a</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">scope-b</span>
      <span class="hljs-attr">target_audience:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-service.com/api/users</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-service.com/api/devices</span>
      <span class="hljs-attr">trusted_issuers:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">https://my-issuer.com/</span>
      <span class="hljs-attr">allowed_algorithms:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">RS256</span>
      <span class="hljs-attr">token_from:</span>
        <span class="hljs-attr">query_parameter:</span> <span class="hljs-string">auth-token</span>
        <span class="hljs-comment"># or</span>
        <span class="hljs-comment"># header: Custom-Authorization-Header</span>
        <span class="hljs-comment"># or</span>
        <span class="hljs-comment"># cookie: auth-token</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="validation-example"></a><a href="#validation-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Validation example</h4>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"handler"</span>: <span class="hljs-string">"jwt"</span>,
  <span class="hljs-attr">"config"</span>: {
    <span class="hljs-attr">"required_scope"</span>: [<span class="hljs-string">"scope-a"</span>, <span class="hljs-string">"scope-b"</span>],
    <span class="hljs-attr">"target_audience"</span>: [
      <span class="hljs-string">"https://my-service.com/api/users"</span>,
      <span class="hljs-string">"https://my-service.com/api/devices"</span>
    ],
    <span class="hljs-attr">"trusted_issuers"</span>: [<span class="hljs-string">"https://my-issuer.com/"</span>],
    <span class="hljs-attr">"allowed_algorithms"</span>: [<span class="hljs-string">"RS256"</span>, <span class="hljs-string">"RS256"</span>]
  }
}
</code></pre>
<p>That exemplary Access Rule consider the following (decoded) JSON Web Token as
valid:</p>
<pre><code class="hljs">{
  <span class="hljs-attr">"alg"</span>: <span class="hljs-string">"RS256"</span>
}
{
  <span class="hljs-attr">"iss"</span>: <span class="hljs-string">"https://my-issuer.com/"</span>,
  <span class="hljs-attr">"aud"</span>: [<span class="hljs-string">"https://my-service.com/api/users"</span>, <span class="hljs-string">"https://my-service.com/api/devices"</span>],
  <span class="hljs-attr">"scp"</span>: [<span class="hljs-string">"scope-a"</span>, <span class="hljs-string">"scope-b"</span>]
}
</code></pre>
<p>And this token as invalid (audience is missing, issuer is not matching, scope is
missing, wrong algorithm):</p>
<pre><code class="hljs">{
  <span class="hljs-attr">"alg"</span>: <span class="hljs-string">"HS256"</span>
}
{
  <span class="hljs-attr">"iss"</span>: <span class="hljs-string">"https://not-my-issuer.com/"</span>,
  <span class="hljs-attr">"aud"</span>: [<span class="hljs-string">"https://my-service.com/api/users"</span>],
  <span class="hljs-attr">"scp"</span>: [<span class="hljs-string">"not-scope-a"</span>, <span class="hljs-string">"scope-b"</span>]
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="scope"></a><a href="#scope" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scope</h3>
<p>JSON Web Tokens can be scoped. However, that feature is not standardized and
several claims that represent the token scope have been seen in the wild: <code>scp</code>,
<code>scope</code>, <code>scopes</code>. Additionally, the claim value can be a string (<code>&quot;scope-a&quot;</code>),
a space-delimited string (<code>&quot;scope-a scope-b&quot;</code>) or a JSON string array
(<code>[&quot;scope-a&quot;, &quot;scope-b&quot;]</code>). Because of this ambiguity, all of those claims are
checked and parsed and will be available as <code>scp</code> (string array) in the
authentication session (<code>.Extra[&quot;scp&quot;]</code>).</p>
<h3><a class="anchor" aria-hidden="true" id="access-rule-example-6"></a><a href="#access-rule-example-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Access Rule Example</h3>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> cat ./rules.json</span>

[{
  "id": "some-id",
  "upstream": {
    "url": "http://my-backend-service"
  },
  "match": {
    "url": "http://my-app/some-route",
    "methods": [
      "GET"
    ]
  },
  "authenticators": [{
    "handler": "jwt",
    "config": {
      "required_scope": ["scope-a", "scope-b"],
      "target_audience": ["aud-1"],
      "trusted_issuers": ["iss-1"]
    }
  }],
  "authorizer": { "handler": "allow" },
  "mutators": [{ "handler": "noop" }]
}]
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET http://my-app/some-route</span>

HTTP/1.0 401 Status Unauthorized
The request is not authorized because no credentials have been provided.
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET -H <span class="hljs-string">'Authorization: Bearer invalid-token'</span> http://my-app/some-route</span>

HTTP/1.0 401 Status Unauthorized
The request is not authorized because the provided credentials are invalid.
<span class="hljs-meta">
$</span><span class="bash"> curl -X GET -H <span class="hljs-string">'Authorization: Bearer valid.jwtfrom.peter'</span> http://my-app/some-route</span>

HTTP/1.0 200 OK
The request has been allowed! The subject is: "peter"
</code></pre>
<p>In the background, this handler will fetch all JSON Web Key Sets provided by
configuration key <code>authenticators.jwt.jwks_urls</code> and use those keys to verify
the signature. If the signature can not be verified by any of those keys, the
JWT is considered invalid.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 1/16/2020 by ORY Continuous Integration</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/next/oathkeeper/pipeline/index"><span class="arrow-prev">← </span><span>Access Rule Pipeline</span></a><a class="docs-next button" href="/docs/next/oathkeeper/pipeline/authz"><span>Authorizers</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#noop"><code>noop</code></a><ul class="toc-headings"><li><a href="#configuration">Configuration</a></li><li><a href="#access-rule-example">Access Rule Example</a></li></ul></li><li><a href="#unauthorized"><code>unauthorized</code></a><ul class="toc-headings"><li><a href="#configuration-1">Configuration</a></li><li><a href="#access-rule-example-1">Access Rule Example</a></li></ul></li><li><a href="#anonymous"><code>anonymous</code></a><ul class="toc-headings"><li><a href="#configuration-2">Configuration</a></li><li><a href="#access-rule-example-2">Access Rule Example</a></li></ul></li><li><a href="#cookie_session"><code>cookie_session</code></a><ul class="toc-headings"><li><a href="#configuration-3">Configuration</a></li><li><a href="#access-rule-example-3">Access Rule Example</a></li></ul></li><li><a href="#oauth2_client_credentials"><code>oauth2_client_credentials</code></a><ul class="toc-headings"><li><a href="#configuration-4">Configuration</a></li><li><a href="#access-rule-example-4">Access Rule Example</a></li></ul></li><li><a href="#oauth2_introspection"><code>oauth2_introspection</code></a><ul class="toc-headings"><li><a href="#configuration-5">Configuration</a></li><li><a href="#access-rule-example-5">Access Rule Example</a></li></ul></li><li><a href="#jwt"><code>jwt</code></a><ul class="toc-headings"><li><a href="#configuration-6">Configuration</a></li><li><a href="#scope">Scope</a></li><li><a href="#access-rule-example-6">Access Rule Example</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2020 ORY GmbH</section><div id="codefund"></div><script src="https://codefund.io/properties/140/funder.js" async=""></script><script>(function () {
  document.querySelectorAll('.tabs .tabs-nav .nav-item a').forEach(function (t) {
    t.addEventListener("click", function (e) {
      e.preventDefault();

      t.closest('.tabs-nav').querySelectorAll('.nav-item a').forEach(function (i) {
        i.classList.remove('active');
      });

      t.closest('.tabs').querySelectorAll('.tab-content .tab-pane').forEach(function (i) {
        i.classList.remove('active');
      });

      t.classList.add('active');
      document.getElementById(t.href.split('#')[1]).classList.add('active');
      return false
    });
  });
})();</script></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '8463c6ece843b377565726bb4ed325b0',
                indexName: 'ory',
                inputSelector: '#search_input_react'
              });
            </script></body></html>