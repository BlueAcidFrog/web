
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Access Control Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Aeneas Rekkas">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-etoc/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-versions-ory/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../3-install/0-README.html" />
    
    
    <link rel="prev" href="2-jwk.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../">
            
                <a href="../">
            
                    
                    ORY Hydra
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../0-tutorial/0-README.html">
            
                <a href="../0-tutorial/0-README.html">
            
                    
                    5 Minute Tutorial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../1-environment/0-README.html">
            
                <a href="../1-environment/0-README.html">
            
                    
                    Dependencies & Environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="0-README.html">
            
                <a href="0-README.html">
            
                    
                    Concepts and Theory
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="1-oauth2.html">
            
                <a href="1-oauth2.html">
            
                    
                    OAuth 2.0 & OpenID Connect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="2-jwk.html">
            
                <a href="2-jwk.html">
            
                    
                    JSON Web Keys
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.3.3" data-path="3-access-control.html">
            
                <a href="3-access-control.html">
            
                    
                    Access Control
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../3-install/0-README.html">
            
                <a href="../3-install/0-README.html">
            
                    
                    Install, Configure and Run ORY Hydra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../4-security/0-README.html">
            
                <a href="../4-security/0-README.html">
            
                    
                    Security Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../5-telemetry/0-README.html">
            
                <a href="../5-telemetry/0-README.html">
            
                    
                    Telemetry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../6-how-to/0-README.html">
            
                <a href="../6-how-to/0-README.html">
            
                    
                    How To
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1" data-path="../6-how-to/1-production.html">
            
                <a href="../6-how-to/1-production.html">
            
                    
                    ORY Hydra in production
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../7-sdk/0-README.html">
            
                <a href="../7-sdk/0-README.html">
            
                    
                    SDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.8.1" data-path="../7-sdk/1-go.html">
            
                <a href="../7-sdk/1-go.html">
            
                    
                    Go SDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.2" data-path="../7-sdk/2-js.html">
            
                <a href="../7-sdk/2-js.html">
            
                    
                    JavaScript SDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.3" data-path="../7-sdk/3-php.html">
            
                <a href="../7-sdk/3-php.html">
            
                    
                    PHP SDK
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../8-faq/0-README.html">
            
                <a href="../8-faq/0-README.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../2-oathkeeper/">
            
                <a href="../../2-oathkeeper/">
            
                    
                    ORY Oathkeeper
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../2-oathkeeper/1-Quickstart/0-README.html">
            
                <a href="../../2-oathkeeper/1-Quickstart/0-README.html">
            
                    
                    Quickstart
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../2-oathkeeper/1-Quickstart/1-INSTALLATION.html">
            
                <a href="../../2-oathkeeper/1-Quickstart/1-INSTALLATION.html">
            
                    
                    Installing ORY Oathkeeper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../2-oathkeeper/1-Quickstart/2-EXECUTION.html">
            
                <a href="../../2-oathkeeper/1-Quickstart/2-EXECUTION.html">
            
                    
                    Running ORY Oathkeeper
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../2-oathkeeper/2-Concepts/0-README.html">
            
                <a href="../../2-oathkeeper/2-Concepts/0-README.html">
            
                    
                    Concepts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../../2-oathkeeper/2-Concepts/1-TERMINOLOGY.html">
            
                <a href="../../2-oathkeeper/2-Concepts/1-TERMINOLOGY.html">
            
                    
                    Terminology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../../2-oathkeeper/2-Concepts/2-RULES.html">
            
                <a href="../../2-oathkeeper/2-Concepts/2-RULES.html">
            
                    
                    Rules
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../2-oathkeeper/3-Deyploment/0-README.html">
            
                <a href="../../2-oathkeeper/3-Deyploment/0-README.html">
            
                    
                    Deployment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../2-oathkeeper/4-Security/0-README.html">
            
                <a href="../../2-oathkeeper/4-Security/0-README.html">
            
                    
                    Security
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Access Control</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="access-control">Access Control</h1>
<!-- toc --><div id="toc" class="toc">

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#warden-api">Warden API</a></li>
<li><a href="#groups">Groups</a></li>
<li><a href="#best-practices">Best Practices</a><ul>
<li><a href="#scalability">Scalability</a></li>
<li><a href="#urns">URNs</a></li>
<li><a href="#scope-the-organization-name">Scope the Organization Name</a></li>
<li><a href="#scope-actions-resources-and-subjects">Scope Actions, Resources and Subjects</a></li>
<li><a href="#multi-tenant-systems">Multi-Tenant Systems</a></li>
</ul>
</li>
<li><a href="#conditions--context">Conditions &amp; Context</a><ul>
<li><a href="#cidr-condition">CIDR Condition</a></li>
<li><a href="#string-equal-condition">String Equal Condition</a></li>
<li><a href="#string-match-condition">String Match Condition</a></li>
<li><a href="#subject-condition">Subject Condition</a></li>
<li><a href="#string-pairs-equal-condition">String Pairs Equal Condition</a></li>
</ul>
</li>
</ul>

</div><!-- tocstop -->
<p>OAuth 2.0 is a protocol that allows applications to act on a user&apos;s behalf,
without knowing their credentials. While it offers a secure flow for applications
(web apps, mobile apps, touchpoints, IoT) to gain access to your APIs,
it does not specify what access rights users actually have.
The frequent question &quot;is the user actually allowed to access that resource?&quot;
is not answered by OAuth 2.0, nor by OpenID Connect.</p>
<p>For that reason, ORY Hydra offers something we call Access Control Policies.
If you ever worked with Google Cloud IAM or AWS IAM, you probably know
what these policies look like. Access Control Policies are a powerful tool
capable of modeling simple and complex access control environments, such as
simple read/write APIs or complex multi-tenant environments.</p>
<p>The next sections give you an overview and best practices of these principles.</p>
<h2 id="introduction">Introduction</h2>
<p>Using <strong>Access Control Policies</strong>, Hydra is able to answer the question:</p>
<blockquote>
<p><strong>Who</strong> is <strong>able</strong> to do <strong>what</strong> on <strong>something</strong> under a certain <strong>circumstance</strong></p>
</blockquote>
<ul>
<li><strong>Who</strong> An arbitrary unique subject name, for example &quot;ken&quot; or &quot;printer-service.mydomain.com&quot;.</li>
<li><strong>Able</strong>: The effect which can be either &quot;allow&quot; or &quot;deny&quot;.</li>
<li><strong>What</strong>: An arbitrary action name, for example &quot;delete&quot;, &quot;create&quot; or &quot;scoped:action:something&quot;.</li>
<li><strong>Something</strong>: An arbitrary unique resource name, for example &quot;something&quot;, &quot;resources.articles.1234&quot; or some uniform
  resource name like &quot;urn:isbn:3827370191&quot;.</li>
<li><strong>Circumstance</strong>: The circumstance under which the policy can be applied. Typically contains information about the
  environment such as the IP Address, the time or date of access, or ownership. (optional)</li>
</ul>
<p>The evaluation logic follows these rules: </p>
<ul>
<li>By default, all requests are denied.</li>
<li>An explicit allow overrides this default.</li>
<li>An explicit deny overrides any allows.</li>
</ul>
<p>To decide whether access is allowed or not, ORY Hydra uses Access Control Policies represented as JSON. Values <code>actions</code>, <code>subjects</code>
and <code>resources</code> can use regular expressions by encapsulating the expression in <code>&lt;&gt;</code>, for example <code>&lt;.*&gt;</code>.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;One policy to rule them all.&quot;</span>,
  <span class="hljs-string">&quot;subjects&quot;</span>: [<span class="hljs-string">&quot;users:&lt;[peter|ken]&gt;&quot;</span>, <span class="hljs-string">&quot;users:maria&quot;</span>, <span class="hljs-string">&quot;groups:admins&quot;</span>],
  <span class="hljs-string">&quot;actions&quot;</span> : [<span class="hljs-string">&quot;delete&quot;</span>, <span class="hljs-string">&quot;&lt;[create|update]&gt;&quot;</span>],
  <span class="hljs-string">&quot;effect&quot;</span>: <span class="hljs-string">&quot;allow&quot;</span>,
  <span class="hljs-string">&quot;resources&quot;</span>: [
    <span class="hljs-string">&quot;resources:articles:&lt;.*&gt;&quot;</span>,
    <span class="hljs-string">&quot;resources:printer&quot;</span>
  ],
  <span class="hljs-string">&quot;conditions&quot;</span>: {
    <span class="hljs-string">&quot;remoteIP&quot;</span>: {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;CIDRCondition&quot;</span>,
        <span class="hljs-string">&quot;options&quot;</span>: {
            <span class="hljs-string">&quot;cidr&quot;</span>: <span class="hljs-string">&quot;192.168.0.1/16&quot;</span>
        }
    }
  }
}
</code></pre>
<p>Now, Hydra is able to answer access requests like the following one:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:peter&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resource:articles:ladon-introduction&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;remoteIP&quot;</span>: <span class="hljs-string">&quot;192.168.0.5&quot;</span>
  }
}
</code></pre>
<p>In this case, the access request will be allowed:</p>
<ol>
<li><code>users:peter</code> matches <code>&quot;subjects&quot;: [&quot;users:&lt;[peter|ken]&gt;&quot;, &quot;users:maria&quot;, &quot;groups:admins&quot;]</code>, as would <code>users:ken</code>, <code>users:maria</code> and <code>group:admins</code>.</li>
<li><code>delete</code> matches <code>&quot;actions&quot; : [&quot;delete&quot;, &quot;&lt;[create|update]&gt;&quot;]</code> as would <code>update</code> and <code>create</code></li>
<li><code>resource:articles:ladon-introduction</code> matches <code>&quot;resources&quot;: [&quot;resources:articles:&lt;.*&gt;&quot;, &quot;resources:printer&quot;],</code></li>
<li><code>&quot;remoteIP&quot;: &quot;192.168.0.5&quot;</code> matches the <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing" target="_blank"><code>CIDRCondition</code></a>
condition that was configured for the field <code>remoteIP</code>.</li>
</ol>
<h2 id="warden-api">Warden API</h2>
<p>The warden is a HTTP API allowing you to perform access requests.
The warden knows two endpoints:</p>
<ul>
<li><code>/warden/allowed</code>: Check if a subject is allowed to do something.</li>
<li><code>/warden/token/allowed</code>: Check if the subject of a token is allowed to do something.</li>
</ul>
<p>Both endpoints use Access Control Policies as documented in the next sections to compute the result.
The API endpoints are documented in the <a href="http://docs.hydra13.apiary.io/#reference/warden:-access-control" target="_blank">HTTP API Documentation</a>.</p>
<h2 id="groups">Groups</h2>
<p>Subjects can be grouped together using the <a href="https://hydra13.docs.apiary.io/#reference/warden/wardengroups" target="_blank">Warden Group API</a>.
This allows to create a set of groups (e.g. <code>admin</code>, <code>moderator</code>) with a specific set of policies attached to them.
A subject (e.g. a human or a service) belonging to one or more groups inherits all policies attached to those groups.</p>
<h2 id="best-practices">Best Practices</h2>
<p>This sections gives an overview of best practices for access control policies
we developed over the years at ORY.</p>
<h3 id="scalability">Scalability</h3>
<p>Access Control Policies not using any regular expressions are quite scalable. Defining many regular expressions and
a lot of policies (50.000+) may have a notable performance impact on CPU, your database and generally increase response
times. This is because regular expressions can not be indexed. Regular expressions have a complexity of <code>O(n)</code> in Go,
but that is still getting slow when you define too many.</p>
<p>Try to solve your access control definitions with a few generalized policies, and try to leverage Warden Groups.</p>
<h3 id="urns">URNs</h3>
<blockquote>
<p>&#x201C;There are only two hard things in Computer Science: cache invalidation and naming things.&#x201D;
-- Phil Karlton</p>
</blockquote>
<p>URN naming is as hard as naming API endpoints. Thankfully, by doing the latter, the former is usually solved as well.
We will explore further best practices in the following sections.</p>
<h3 id="scope-the-organization-name">Scope the Organization Name</h3>
<p>A rule of thumb is to prefix resource names with a domain that represents the organization creating the software.</p>
<ul>
<li><strong>Do not:</strong> <code>&lt;some-id&gt;</code></li>
<li><strong>Do:</strong> <code>&lt;organizaion-id&gt;:&lt;some-id&gt;</code></li>
</ul>
<h3 id="scope-actions-resources-and-subjects">Scope Actions, Resources and Subjects</h3>
<p>It is wise to scope actions, resources, and subjects in order to prevent name collisions:</p>
<ul>
<li><strong>Do not:</strong> <code>myorg.com:&lt;subject-id&gt;</code>, <code>myorg.com:&lt;resource-id&gt;</code>, <code>myorg.com:&lt;action-id&gt;</code></li>
<li><strong>Do:</strong> <code>myorg.com:subjects:&lt;subject-id&gt;</code>, <code>myorg.com:resources:&lt;resource-id&gt;</code>, <code>myorg.com:actions:&lt;action-id&gt;</code></li>
<li><strong>Do:</strong> <code>subjects:myorg.com:&lt;subject-id&gt;</code>, <code>resources:myorg.com:&lt;resource-id&gt;</code>, <code>actions:myorg.com:&lt;action-id&gt;</code></li>
</ul>
<h3 id="multi-tenant-systems">Multi-Tenant Systems</h3>
<p>Multi-tenant systems typically have resources which should not be access by other tenants in the system. This can be
achieved by adding the tenant id to the URN:</p>
<ul>
<li><strong>Do:</strong> <code>resources:myorg.com:tenants:&lt;tenant-id&gt;:&lt;resource-id&gt;</code></li>
</ul>
<p>In some environments, it is common to have organizations and projects belonging to those organizations. Here, the
following URN semantics can be used:</p>
<ul>
<li><strong>Do:</strong> <code>resources:myorg.com:organizations:&lt;organization-id&gt;:projects:&lt;project-id&gt;:&lt;resource-id&gt;</code></li>
</ul>
<h2 id="conditions--context">Conditions &amp; Context</h2>
<p>Conditions are defined in policies. Contexts are defined in access control requests. Conditions use contexts and decide
if a policy is responsible for handling the access request at hand.</p>
<p>Conditions are functions returning true or false given a context. Because conditions implement logic,
they must be programmed. ORY Hydra uses conditions defined in <a href="https://github.com/ory/ladon/#conditions" target="_blank">ORY Ladon</a>.
Adding new condition handlers must be done through creating a pull request in the ORY Ladon repository.</p>
<p>A condition has always the same JSON format:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subjects&quot;</span>: [<span class="hljs-string">&quot;...&quot;</span>],
  <span class="hljs-string">&quot;actions&quot;</span> : [<span class="hljs-string">&quot;...&quot;</span>],
  <span class="hljs-string">&quot;effect&quot;</span>: <span class="hljs-string">&quot;allow&quot;</span>,
  <span class="hljs-string">&quot;resources&quot;</span>: [<span class="hljs-string">&quot;...&quot;</span>],
  <span class="hljs-string">&quot;conditions&quot;</span>: {
    <span class="hljs-string">&quot;this-key-will-be-matched-with-the-context&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;SomeConditionType&quot;</span>,
      <span class="hljs-string">&quot;options&quot;</span>: {
        <span class="hljs-string">&quot;some&quot;</span>: <span class="hljs-string">&quot;configuration options set by the condition type&quot;</span>
      }
    }
  }
}
</code></pre>
<p>The context in the access request made to ORY Hydra&apos;s Warden API must match the specified key in the condition
in order to be evaluated by the condition logic:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;...&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;this-key-will-be-matched-with-the-context&quot;</span>: { <span class="hljs-string">&quot;foo&quot;</span>: <span class="hljs-string">&quot;bar&quot;</span> }
  }
}
</code></pre>
<h3 id="cidr-condition">CIDR Condition</h3>
<p>The CIDR condition matches CIDR IP Ranges. An exemplary policy definition could look as follows.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;One policy to rule them all.&quot;</span>,
  <span class="hljs-string">&quot;subjects&quot;</span>: [<span class="hljs-string">&quot;users:maria&quot;</span>],
  <span class="hljs-string">&quot;actions&quot;</span> : [<span class="hljs-string">&quot;delete&quot;</span>, <span class="hljs-string">&quot;create&quot;</span>, <span class="hljs-string">&quot;update&quot;</span>],
  <span class="hljs-string">&quot;effect&quot;</span>: <span class="hljs-string">&quot;allow&quot;</span>,
  <span class="hljs-string">&quot;resources&quot;</span>: [<span class="hljs-string">&quot;resources:articles:&lt;.*&gt;&quot;</span>],
  <span class="hljs-string">&quot;conditions&quot;</span>: {
    <span class="hljs-string">&quot;remoteIPAddress&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;CIDRCondition&quot;</span>,
      <span class="hljs-string">&quot;options&quot;</span>: {
        <span class="hljs-string">&quot;cidr&quot;</span>: <span class="hljs-string">&quot;192.168.0.0/16&quot;</span>
      }
    }
  }
}
</code></pre>
<p>The following access request would be allowed.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;remoteIPAddress&quot;</span>: <span class="hljs-string">&quot;192.168.0.5&quot;</span>
  }
}
</code></pre>
<p>The next access request would be denied as the condition is not fulfilled and thus no policy is matched.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;remoteIPAddress&quot;</span>: <span class="hljs-string">&quot;255.255.0.0&quot;</span>
  }
}
</code></pre>
<p>The next access request would also be denied as the context is not using the key <code>remoteIPAddress</code> but instead <code>someOtherKey</code>.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;someOtherKey&quot;</span>: <span class="hljs-string">&quot;192.168.0.5&quot;</span>
  }
}
</code></pre>
<h3 id="string-equal-condition">String Equal Condition</h3>
<p>Checks if the value passed in the access request&apos;s context is identical with the string that was given initially.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;One policy to rule them all.&quot;</span>,
  <span class="hljs-string">&quot;subjects&quot;</span>: [<span class="hljs-string">&quot;users:maria&quot;</span>],
  <span class="hljs-string">&quot;actions&quot;</span> : [<span class="hljs-string">&quot;delete&quot;</span>, <span class="hljs-string">&quot;create&quot;</span>, <span class="hljs-string">&quot;update&quot;</span>],
  <span class="hljs-string">&quot;effect&quot;</span>: <span class="hljs-string">&quot;allow&quot;</span>,
  <span class="hljs-string">&quot;resources&quot;</span>: [<span class="hljs-string">&quot;resources:articles:&lt;.*&gt;&quot;</span>],
  <span class="hljs-string">&quot;conditions&quot;</span>: {
    <span class="hljs-string">&quot;someKeyName&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;StringEqualCondition&quot;</span>,
      <span class="hljs-string">&quot;options&quot;</span>: {
        <span class="hljs-string">&quot;equals&quot;</span>: <span class="hljs-string">&quot;the-value-should-be-this&quot;</span>
      }
    }
  }
}
</code></pre>
<p>The following access request would be allowed.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;someKeyName&quot;</span>: <span class="hljs-string">&quot;the-value-should-be-this&quot;</span>
  }
}
</code></pre>
<p>The following access request would be denied.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;someKeyName&quot;</span>: <span class="hljs-string">&quot;this-is-a-different-value&quot;</span>
  }
}
</code></pre>
<h3 id="string-match-condition">String Match Condition</h3>
<p>Checks if the value passed in the access request&apos;s context matches the regular expression that was given initially.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;One policy to rule them all.&quot;</span>,
  <span class="hljs-string">&quot;subjects&quot;</span>: [<span class="hljs-string">&quot;users:maria&quot;</span>],
  <span class="hljs-string">&quot;actions&quot;</span> : [<span class="hljs-string">&quot;delete&quot;</span>, <span class="hljs-string">&quot;create&quot;</span>, <span class="hljs-string">&quot;update&quot;</span>],
  <span class="hljs-string">&quot;effect&quot;</span>: <span class="hljs-string">&quot;allow&quot;</span>,
  <span class="hljs-string">&quot;resources&quot;</span>: [<span class="hljs-string">&quot;resources:articles:&lt;.*&gt;&quot;</span>],
  <span class="hljs-string">&quot;conditions&quot;</span>: {
    <span class="hljs-string">&quot;someKeyName&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;StringMatchCondition&quot;</span>,
      <span class="hljs-string">&quot;options&quot;</span>: {
        <span class="hljs-string">&quot;equals&quot;</span>: <span class="hljs-string">&quot;regex-pattern-here.+&quot;</span>
      }
    }
  }
}
</code></pre>
<p>The following access request would be allowed.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;someKeyName&quot;</span>: <span class="hljs-string">&quot;regex-pattern-here-matches&quot;</span>
  }
}
</code></pre>
<p>The following access request would be denied.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;someKeyName&quot;</span>: <span class="hljs-string">&quot;regex-pattern-here&quot;</span>
  }
}
</code></pre>
<h3 id="subject-condition">Subject Condition</h3>
<p>Checks if the access request&apos;s subject is identical with the string specified in the context.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;One policy to rule them all.&quot;</span>,
  <span class="hljs-string">&quot;subjects&quot;</span>: [<span class="hljs-string">&quot;users:maria&quot;</span>],
  <span class="hljs-string">&quot;actions&quot;</span> : [<span class="hljs-string">&quot;delete&quot;</span>, <span class="hljs-string">&quot;create&quot;</span>, <span class="hljs-string">&quot;update&quot;</span>],
  <span class="hljs-string">&quot;effect&quot;</span>: <span class="hljs-string">&quot;allow&quot;</span>,
  <span class="hljs-string">&quot;resources&quot;</span>: [<span class="hljs-string">&quot;resources:articles:&lt;.*&gt;&quot;</span>],
  <span class="hljs-string">&quot;conditions&quot;</span>: {
    <span class="hljs-string">&quot;owner&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;EqualsSubjectCondition&quot;</span>,
      <span class="hljs-string">&quot;options&quot;</span>: {}
    }
  }
}
</code></pre>
<p>The following access request would be allowed.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;owner&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>
  }
}
</code></pre>
<p>The following access request would be denied.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;owner&quot;</span>: <span class="hljs-string">&quot;another-user&quot;</span>
  }
}
</code></pre>
<p>This condition makes more sense when being used with access tokens where the subject is extracted from the token.</p>
<h3 id="string-pairs-equal-condition">String Pairs Equal Condition</h3>
<p>Checks if the value passed in the access request&apos;s context contains two-element arrays and that both elements in each pair are equal.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;One policy to rule them all.&quot;</span>,
  <span class="hljs-string">&quot;subjects&quot;</span>: [<span class="hljs-string">&quot;users:maria&quot;</span>],
  <span class="hljs-string">&quot;actions&quot;</span> : [<span class="hljs-string">&quot;delete&quot;</span>, <span class="hljs-string">&quot;create&quot;</span>, <span class="hljs-string">&quot;update&quot;</span>],
  <span class="hljs-string">&quot;effect&quot;</span>: <span class="hljs-string">&quot;allow&quot;</span>,
  <span class="hljs-string">&quot;resources&quot;</span>: [<span class="hljs-string">&quot;resources:articles:&lt;.*&gt;&quot;</span>],
  <span class="hljs-string">&quot;conditions&quot;</span>: {
    <span class="hljs-string">&quot;someKey&quot;</span>: {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;StringPairsEqualCondition&quot;</span>,
      <span class="hljs-string">&quot;options&quot;</span>: {}
    }
  }
}
</code></pre>
<p>The following access request would be allowed.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;someKey&quot;</span>: [
      [<span class="hljs-string">&quot;some-arbitrary-pair-value&quot;</span>, <span class="hljs-string">&quot;some-arbitrary-pair-value&quot;</span>],
      [<span class="hljs-string">&quot;some-other-arbitrary-pair-value&quot;</span>, <span class="hljs-string">&quot;some-other-arbitrary-pair-value&quot;</span>]
    ]
  }
}
</code></pre>
<p>The following access request would be denied.</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;users:maria&quot;</span>,
  <span class="hljs-string">&quot;action&quot;</span> : <span class="hljs-string">&quot;delete&quot;</span>,
  <span class="hljs-string">&quot;resource&quot;</span>: <span class="hljs-string">&quot;resources:articles:12345&quot;</span>,
  <span class="hljs-string">&quot;context&quot;</span>: {
    <span class="hljs-string">&quot;someKey&quot;</span>: [
      [<span class="hljs-string">&quot;some-arbitrary-pair-value&quot;</span>, <span class="hljs-string">&quot;some-other-arbitrary-pair-value&quot;</span>]
    ]
  }
}
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="2-jwk.html" class="navigation navigation-prev " aria-label="Previous page: JSON Web Keys">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../3-install/0-README.html" class="navigation navigation-next " aria-label="Next page: Install, Configure and Run ORY Hydra">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Access Control","level":"1.2.3.3","depth":3,"next":{"title":"Install, Configure and Run ORY Hydra","level":"1.2.4","depth":2,"path":"1-hydra/3-install/0-README.md","ref":"1-hydra/3-install/0-README.md","articles":[]},"previous":{"title":"JSON Web Keys","level":"1.2.3.2","depth":3,"path":"1-hydra/2-overview/2-jwk.md","ref":"1-hydra/2-overview/2-jwk.md","articles":[]},"dir":"ltr"},"config":{"plugins":["edit-link","etoc","ga","sitemap-basepath","versions-ory"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"etoc":{"h2lb":2,"header":1,"maxdepth":5,"mindepth":2,"notoc":false},"versions-ory":{"type":"branches"},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sitemap-basepath":{"hostname":"https://www.ory.sh/","basePath":"/docs/guides/"},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"ga":{"configuration":"auto","token":"UA-71865250-1"},"versions":{"gitbookConfigURL":"https://raw.githubusercontent.com/ory/docs/master/guides/book.json","options":[{"value":"https://www.ory.sh/docs/guides/latest","text":"latest"},{"value":"https://www.ory.sh/docs/guides/v0.11.12","text":"0.11.12"}]},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit this page","base":"https://github.com/ory/docs/tree/master/guides"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Aeneas Rekkas","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":">=3.2.3"},"file":{"path":"1-hydra/2-overview/3-access-control.md","mtime":"2018-05-17T09:00:37.133Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-05-17T17:11:26.052Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-etoc/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-versions-ory/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

